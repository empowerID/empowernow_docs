<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-services/aria-shield/capability-proofs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Privacy-Preserving Capability Proofs — Deep Intro &amp; How-It-Works (for PMs) | EmpowerNow Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://empowerid.github.io/empowernow_docs/img/empowernow-logo.svg"><meta data-rh="true" name="twitter:image" content="https://empowerid.github.io/empowernow_docs/img/empowernow-logo.svg"><meta data-rh="true" property="og:url" content="https://empowerid.github.io/empowernow_docs/docs/services/aria-shield/capability-proofs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Privacy-Preserving Capability Proofs — Deep Intro &amp; How-It-Works (for PMs) | EmpowerNow Docs"><meta data-rh="true" name="description" content="One-liner"><meta data-rh="true" property="og:description" content="One-liner"><link data-rh="true" rel="icon" href="/empowernow_docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://empowerid.github.io/empowernow_docs/docs/services/aria-shield/capability-proofs"><link data-rh="true" rel="alternate" href="https://empowerid.github.io/empowernow_docs/docs/services/aria-shield/capability-proofs" hreflang="en"><link data-rh="true" rel="alternate" href="https://empowerid.github.io/empowernow_docs/docs/services/aria-shield/capability-proofs" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ARIA Shield","item":"https://empowerid.github.io/empowernow_docs/docs/services/aria-shield/"},{"@type":"ListItem","position":2,"name":"Privacy-Preserving Capability Proofs — Deep Intro & How-It-Works (for PMs)","item":"https://empowerid.github.io/empowernow_docs/docs/services/aria-shield/capability-proofs"}]}</script><link rel="stylesheet" href="/empowernow_docs/assets/css/styles.b212d4ba.css">
<script src="/empowernow_docs/assets/js/runtime~main.b7e4b38b.js" defer="defer"></script>
<script src="/empowernow_docs/assets/js/main.288af713.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/empowernow_docs/img/en-logo-light.png"><link rel="preload" as="image" href="/empowernow_docs/img/en-logo-dark.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/empowernow_docs/"><div class="navbar__logo"><img src="/empowernow_docs/img/en-logo-light.png" alt="EmpowerNow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/empowernow_docs/img/en-logo-dark.png" alt="EmpowerNow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/empowernow_docs/">Home</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/solutions">Solutions</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/products">Products</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/pricing">Pricing</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/trust">Trust</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/resources">Resources</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/company">Company</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/empowernow_docs/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/services/crud-service/explanation/secrets-executive-overview">Secrets Overview</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/services/bff/explanation/executive-overview">BFF Overview</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/services/bff/explanation/bff-visual-guide">BFF Visual Guide</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/empowerID/empowernow_docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/intro">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/empowernow_docs/docs/services/identity-fabric">Services</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/identity-fabric">Identity Fabric</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/crud-service">CRUD Service</a><button aria-label="Expand sidebar category &#x27;CRUD Service&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/bff">BFF</a><button aria-label="Expand sidebar category &#x27;BFF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/pdp">PDP</a><button aria-label="Expand sidebar category &#x27;PDP&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/experience">Experience</a><button aria-label="Expand sidebar category &#x27;Experience&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/empowernow_docs/docs/services/aria-shield">ARIA Shield</a><button aria-label="Collapse sidebar category &#x27;ARIA Shield&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/bdna-monitoring">Behavioral DNA (BDNA) Monitoring — Deep Intro &amp; How-It-Works (for PMs)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/capability-proofs">Privacy-Preserving Capability Proofs — Deep Intro &amp; How-It-Works (for PMs)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield">ARIA Shield</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/intro-architecture">ARIA: Agent Risk &amp; Identity Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/patent-portfolio">ARIA Patent Portfolio: Comprehensive Attorney Brief</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/pm-executive-overview">ARIA: Product Management Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/pm-guide3-tbd">pm-guide3-tbd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/pm-overview">ARIA — Agent Risk &amp; Identity Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/receipt-chains">Receipt Chains (Immutable Audit) — Deep Intro &amp; How-It-Works (for PMs)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/seven-controls-overview">ARIA’s Seven Controls — Plain-Language Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/aria-shield/tool-schema-attestation">Tool Schema Attestation — Deep Intro &amp; How-It-Works (for PMs)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/nowconnect">NowConnect</a><button aria-label="Expand sidebar category &#x27;NowConnect&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/idp">IdP</a><button aria-label="Expand sidebar category &#x27;IdP&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/personas/faq">Personas</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/marketing">Marketing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/enablement/product-review-study-guide">Enablement</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/empowernow_docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Services</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/empowernow_docs/docs/services/aria-shield"><span>ARIA Shield</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Privacy-Preserving Capability Proofs — Deep Intro &amp; How-It-Works (for PMs)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Privacy-Preserving Capability Proofs — Deep Intro &amp; How-It-Works (for PMs)</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-liner">One-liner<a href="#one-liner" class="hash-link" aria-label="Direct link to One-liner" title="Direct link to One-liner">​</a></h2>
<p>Agents prove they hold <em>exactly the permission they need</em> for this call—without revealing the rest of their powers—so tokens stay compact, private, and safer to operate at scale.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-this-matters-business--risk">Why this matters (business + risk)<a href="#why-this-matters-business--risk" class="hash-link" aria-label="Direct link to Why this matters (business + risk)" title="Direct link to Why this matters (business + risk)">​</a></h2>
<ul>
<li><strong>Spending control:</strong> Agents can’t “accidentally” exercise adjacent powers (e.g., <em>refund</em> because they had <em>charge</em>). Each call must carry a proof for the <strong>one</strong> capability it uses.</li>
<li><strong>Privacy &amp; safety:</strong> An attacker or downstream service can’t learn the agent’s full permission set from a token. We disclose the minimum required to complete the task.</li>
<li><strong>Operational scale:</strong> Permissions for hundreds of tools no longer bloat tokens or headers. You carry a single cryptographic <strong>root</strong> and present tiny per-call proofs.</li>
<li><strong>Governance clarity:</strong> Every allow/deny decision is traceable to a specific capability, visible in receipts and dashboards.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-concept-in-plain-language">Core concept in plain language<a href="#core-concept-in-plain-language" class="hash-link" aria-label="Direct link to Core concept in plain language" title="Direct link to Core concept in plain language">​</a></h2>
<p>Think of the agent’s permissions as a <strong>sealed deck</strong>. The token carries one secure “deck ID” (a cryptographic root). When the agent needs to use a specific card—say, <code>tool:stripe:payment.refund</code>—it presents a <strong>small proof</strong> that this card belongs to that deck <em>without revealing the other cards</em>. ARIA checks the proof against the deck ID. If it matches, we proceed; if not, we fail closed.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works-end-to-end">How it works end-to-end<a href="#how-it-works-end-to-end" class="hash-link" aria-label="Direct link to How it works end-to-end" title="Direct link to How it works end-to-end">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-issuance-idp">1) Issuance (IdP)<a href="#1-issuance-idp" class="hash-link" aria-label="Direct link to 1) Issuance (IdP)" title="Direct link to 1) Issuance (IdP)">​</a></h3>
<ul>
<li>
<p>The IdP compiles the approved capability list (from Membership/Graph) into a <strong>capability tree</strong> and signs a token containing:</p>
<ul>
<li>Pairwise agent binding (user-bound principal)</li>
<li><code>cap_root</code> (the cryptographic fingerprint of the full capability set)</li>
<li>References to approved tool attestations (by ID)</li>
<li>Standard OAuth/OIDC claims</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-proof-agent">2) Proof (Agent)<a href="#2-proof-agent" class="hash-link" aria-label="Direct link to 2) Proof (Agent)" title="Direct link to 2) Proof (Agent)">​</a></h3>
<ul>
<li>For each call, the agent requests a <strong>capability proof</strong> for the one capability it intends to use (e.g., via the IdP’s capability-proof endpoint) or builds it locally if it has the tree.</li>
<li>That proof is a short list of hashes that reconstruct the <code>cap_root</code> <strong>only if</strong> the capability is truly in the set.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-enforcement-aria-gateway--pdp">3) Enforcement (ARIA Gateway + PDP)<a href="#3-enforcement-aria-gateway--pdp" class="hash-link" aria-label="Direct link to 3) Enforcement (ARIA Gateway + PDP)" title="Direct link to 3) Enforcement (ARIA Gateway + PDP)">​</a></h3>
<ul>
<li>
<p>ARIA verifies:</p>
<ul>
<li>User-binding, tool attestation, budget/plan, and</li>
<li><strong>Capability proof → cap_root</strong> match.</li>
</ul>
</li>
<li>
<p>ARIA calls the <strong>PDP (OpenID AuthZEN)</strong> with the exercised capability in <code>context.capability</code> and tool info in <code>resource.properties</code>.</p>
</li>
<li>
<p>PDP replies <strong>boolean only</strong> (per AuthZEN draft-04). ARIA enforces the decision and emits a receipt.</p>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sequence-one-call-with-a-capability-proof">Sequence: one call with a capability proof<a href="#sequence-one-call-with-a-capability-proof" class="hash-link" aria-label="Direct link to Sequence: one call with a capability proof" title="Direct link to Sequence: one call with a capability proof">​</a></h2>
<!-- -->
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="verification-logic-at-aria-high-level">Verification logic at ARIA (high-level)<a href="#verification-logic-at-aria-high-level" class="hash-link" aria-label="Direct link to Verification logic at ARIA (high-level)" title="Direct link to Verification logic at ARIA (high-level)">​</a></h2>
<!-- -->
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-in-the-capability-tree-no-code-just-concepts">What’s in the “capability tree” (no code, just concepts)<a href="#whats-in-the-capability-tree-no-code-just-concepts" class="hash-link" aria-label="Direct link to What’s in the “capability tree” (no code, just concepts)" title="Direct link to What’s in the “capability tree” (no code, just concepts)">​</a></h2>
<ul>
<li><strong>Leaves</strong>: canonical capability strings (e.g., <code>tool:&lt;vendor&gt;:&lt;domain&gt;.&lt;action&gt;</code>), optionally <em>domain-separated</em> by tenant/environment to prevent cross-tenant reuse.</li>
<li><strong>Internal nodes</strong>: hashes that summarize children.</li>
<li><strong>Root</strong>: a single hash (the deck ID) placed in the token.</li>
</ul>
<blockquote>
<p>The proof is just the siblings needed to re-compute the root—small, fast to verify, and revealing nothing else.</p>
</blockquote>
<!-- -->
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alignment-with-openid-authzen--pdps">Alignment with <strong>OpenID AuthZEN</strong> &amp; PDPs<a href="#alignment-with-openid-authzen--pdps" class="hash-link" aria-label="Direct link to alignment-with-openid-authzen--pdps" title="Direct link to alignment-with-openid-authzen--pdps">​</a></h2>
<ul>
<li>
<p><strong>Where proofs live:</strong> ARIA verifies the proof locally (PEP responsibility). No spec change is needed.</p>
</li>
<li>
<p><strong>How PDP sees it:</strong> ARIA calls the PDP using <strong>AuthZEN draft-04</strong>, passing:</p>
<ul>
<li><code>subject</code>: the agent principal (user-bound)</li>
<li><code>action</code>: operation name (e.g., <code>execute</code>)</li>
<li><code>resource</code>: the tool, with properties like <code>tool_id</code>, <code>attestation_id</code></li>
<li><code>context</code>: <code>capability</code> = the exact capability proven, plus any budgets, drift scores, or context roots</li>
</ul>
</li>
<li>
<p><strong>Response contract:</strong> PDP returns <strong>only</strong> <code>{&quot;decision&quot;: true|false}</code>. ARIA handles obligations (e.g., receipts, budgets) on its side.</p>
</li>
<li>
<p><strong>Why split roles:</strong></p>
<ul>
<li><strong>PEP (ARIA):</strong> cryptographic verification, runtime enforcement, auditing.</li>
<li><strong>PDP:</strong> policy (who may do what, when, where) using the <em>already-verified</em> capability as input.</li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-buyers-get-value-for-ciocisofinopsdevelopers">What buyers get (value for CIO/CISO/FinOps/Developers)<a href="#what-buyers-get-value-for-ciocisofinopsdevelopers" class="hash-link" aria-label="Direct link to What buyers get (value for CIO/CISO/FinOps/Developers)" title="Direct link to What buyers get (value for CIO/CISO/FinOps/Developers)">​</a></h2>
<ul>
<li><strong>Least disclosure &amp; least privilege by construction</strong>
Every call proves <em>one</em> permission; nothing else is exposed on the wire.</li>
<li><strong>Compact, scalable tokens</strong>
Add hundreds of capabilities without inflating the token—only the root travels; tiny per-call proofs ride alongside.</li>
<li><strong>Clear cost controls</strong>
Because each call names a specific capability, it lines up cleanly with budgets, plan steps, and spend policies.</li>
<li><strong>Interoperable &amp; standards-friendly</strong>
Works with OAuth 2.0 / OIDC tokens and AuthZEN PDPs—no proprietary protocol required.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-this-pairs-with-other-aria-controls">How this pairs with other ARIA controls<a href="#how-this-pairs-with-other-aria-controls" class="hash-link" aria-label="Direct link to How this pairs with other ARIA controls" title="Direct link to How this pairs with other ARIA controls">​</a></h2>
<ul>
<li><strong>Tool Schema Attestation:</strong> Ensures the <em>tool</em> you’re calling is the approved version; capability proof ensures you’re the <em>right actor</em> to call it.</li>
<li><strong>Plan Contracts:</strong> Even with the right capability, the call must match the approved step (params, budgets).</li>
<li><strong>Receipts:</strong> Each decision logs <code>tool_id</code>, <code>capability</code>, and <code>attestation_id</code>—a clean audit trail.</li>
<li><strong>User-Bound Identities:</strong> Proofs are only valid within the user-bound agent context; they can’t be replayed across bindings/tenants.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pm-decisions-to-lock-for-v1">PM decisions to lock for v1<a href="#pm-decisions-to-lock-for-v1" class="hash-link" aria-label="Direct link to PM decisions to lock for v1" title="Direct link to PM decisions to lock for v1">​</a></h2>
<ul>
<li>
<p><strong>Canonical capability namespace</strong> (e.g., <code>tool:&lt;vendor&gt;:&lt;domain&gt;.&lt;action&gt;</code>).</p>
</li>
<li>
<p><strong>Where proofs come from</strong></p>
<ul>
<li>On-demand from IdP’s proof endpoint, or</li>
<li>Pre-fetched &amp; cached client-side, or</li>
<li>Embedded with the token for a small default set.</li>
</ul>
</li>
<li>
<p><strong>Replay protections</strong>
Bind proofs to a call ID or DPoP key when appropriate (PEP validates).</p>
</li>
<li>
<p><strong>Rotation &amp; lifecycle</strong>
How often the tree (and root) rotate when capability sets change; what error UX agents see if proofs are stale.</p>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kpis-to-watch-no-invented-numberstrack-internally">KPIs to watch (no invented numbers—track internally)<a href="#kpis-to-watch-no-invented-numberstrack-internally" class="hash-link" aria-label="Direct link to KPIs to watch (no invented numbers—track internally)" title="Direct link to KPIs to watch (no invented numbers—track internally)">​</a></h2>
<ul>
<li>% of agent calls with valid capability proofs (coverage).</li>
<li>PDP denials due to capability mismatch (policy drift signal).</li>
<li>Token size trend vs. capability count (operational scalability).</li>
<li>Time-to-recover when capability sets change (DX &amp; resiliency).</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="non-goals-to-avoid-confusion">Non-goals (to avoid confusion)<a href="#non-goals-to-avoid-confusion" class="hash-link" aria-label="Direct link to Non-goals (to avoid confusion)" title="Direct link to Non-goals (to avoid confusion)">​</a></h2>
<ul>
<li><strong>Not</strong> a replacement for authorization policy. Proofs show <em>you can</em>; PDP decides <em>whether you may</em> given context.</li>
<li><strong>Not</strong> an API schema validator. That’s handled by Tool Schema Attestation.</li>
<li><strong>Not</strong> a budget mechanism. Budgets/plan contracts still apply independently.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bottom-line">Bottom line<a href="#bottom-line" class="hash-link" aria-label="Direct link to Bottom line" title="Direct link to Bottom line">​</a></h3>
<p>Privacy-Preserving Capability Proofs give you <strong>just-enough disclosure</strong> on every call: strong cryptographic evidence for the one permission being exercised, nothing else. That keeps tokens small, policies clean, audits crisp—and spending and risk under control—while staying fully aligned with OpenID AuthZEN and your existing PDP.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/aria-shield/capability-proofs.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/empowernow_docs/docs/services/aria-shield/bdna-monitoring"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Behavioral DNA (BDNA) Monitoring — Deep Intro &amp; How-It-Works (for PMs)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/empowernow_docs/docs/services/aria-shield"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ARIA Shield</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#one-liner" class="table-of-contents__link toc-highlight">One-liner</a></li><li><a href="#why-this-matters-business--risk" class="table-of-contents__link toc-highlight">Why this matters (business + risk)</a></li><li><a href="#core-concept-in-plain-language" class="table-of-contents__link toc-highlight">Core concept in plain language</a></li><li><a href="#how-it-works-end-to-end" class="table-of-contents__link toc-highlight">How it works end-to-end</a><ul><li><a href="#1-issuance-idp" class="table-of-contents__link toc-highlight">1) Issuance (IdP)</a></li><li><a href="#2-proof-agent" class="table-of-contents__link toc-highlight">2) Proof (Agent)</a></li><li><a href="#3-enforcement-aria-gateway--pdp" class="table-of-contents__link toc-highlight">3) Enforcement (ARIA Gateway + PDP)</a></li></ul></li><li><a href="#sequence-one-call-with-a-capability-proof" class="table-of-contents__link toc-highlight">Sequence: one call with a capability proof</a></li><li><a href="#verification-logic-at-aria-high-level" class="table-of-contents__link toc-highlight">Verification logic at ARIA (high-level)</a></li><li><a href="#whats-in-the-capability-tree-no-code-just-concepts" class="table-of-contents__link toc-highlight">What’s in the “capability tree” (no code, just concepts)</a></li><li><a href="#alignment-with-openid-authzen--pdps" class="table-of-contents__link toc-highlight">Alignment with <strong>OpenID AuthZEN</strong> &amp; PDPs</a></li><li><a href="#what-buyers-get-value-for-ciocisofinopsdevelopers" class="table-of-contents__link toc-highlight">What buyers get (value for CIO/CISO/FinOps/Developers)</a></li><li><a href="#how-this-pairs-with-other-aria-controls" class="table-of-contents__link toc-highlight">How this pairs with other ARIA controls</a></li><li><a href="#pm-decisions-to-lock-for-v1" class="table-of-contents__link toc-highlight">PM decisions to lock for v1</a></li><li><a href="#kpis-to-watch-no-invented-numberstrack-internally" class="table-of-contents__link toc-highlight">KPIs to watch (no invented numbers—track internally)</a></li><li><a href="#non-goals-to-avoid-confusion" class="table-of-contents__link toc-highlight">Non-goals (to avoid confusion)</a><ul><li><a href="#bottom-line" class="table-of-contents__link toc-highlight">Bottom line</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/intro">Getting Started</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Marketing</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/solutions">Solutions</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/pricing">Pricing</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/products">Products</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/trust">Trust</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/resources">Resources</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/company">Company</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/empowerID/empowernow_docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 EmpowerNow. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>