<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-services/crud-service/secrets/canonical-uris-and-policy" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Canonical URIs and policy model | EmpowerNow Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://empowerid.github.io/empowernow_docs/img/empowernow-logo.svg"><meta data-rh="true" name="twitter:image" content="https://empowerid.github.io/empowernow_docs/img/empowernow-logo.svg"><meta data-rh="true" property="og:url" content="https://empowerid.github.io/empowernow_docs/docs/services/crud-service/secrets/canonical-uris-and-policy"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Canonical URIs and policy model | EmpowerNow Docs"><meta data-rh="true" name="description" content="URI schemes, tenant guards, resource refs, and PDP purposes"><meta data-rh="true" property="og:description" content="URI schemes, tenant guards, resource refs, and PDP purposes"><link data-rh="true" rel="icon" href="/empowernow_docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://empowerid.github.io/empowernow_docs/docs/services/crud-service/secrets/canonical-uris-and-policy"><link data-rh="true" rel="alternate" href="https://empowerid.github.io/empowernow_docs/docs/services/crud-service/secrets/canonical-uris-and-policy" hreflang="en"><link data-rh="true" rel="alternate" href="https://empowerid.github.io/empowernow_docs/docs/services/crud-service/secrets/canonical-uris-and-policy" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"CRUD Service","item":"https://empowerid.github.io/empowernow_docs/docs/services/crud-service/"},{"@type":"ListItem","position":2,"name":"Secrets Platform","item":"https://empowerid.github.io/empowernow_docs/docs/services/crud-service/secrets/"},{"@type":"ListItem","position":3,"name":"Canonical URIs and policy model","item":"https://empowerid.github.io/empowernow_docs/docs/services/crud-service/secrets/canonical-uris-and-policy"}]}</script><link rel="stylesheet" href="/empowernow_docs/assets/css/styles.b212d4ba.css">
<script src="/empowernow_docs/assets/js/runtime~main.b7e4b38b.js" defer="defer"></script>
<script src="/empowernow_docs/assets/js/main.288af713.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/empowernow_docs/img/en-logo-light.png"><link rel="preload" as="image" href="/empowernow_docs/img/en-logo-dark.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/empowernow_docs/"><div class="navbar__logo"><img src="/empowernow_docs/img/en-logo-light.png" alt="EmpowerNow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/empowernow_docs/img/en-logo-dark.png" alt="EmpowerNow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/empowernow_docs/">Home</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/solutions">Solutions</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/products">Products</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/pricing">Pricing</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/trust">Trust</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/resources">Resources</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/website_copy/company">Company</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/empowernow_docs/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/services/crud-service/explanation/secrets-executive-overview">Secrets Overview</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/services/bff/explanation/executive-overview">BFF Overview</a><a class="navbar__item navbar__link" href="/empowernow_docs/docs/services/bff/explanation/bff-visual-guide">BFF Visual Guide</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/empowerID/empowernow_docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/intro">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/empowernow_docs/docs/services/identity-fabric">Services</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/identity-fabric">Identity Fabric</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/empowernow_docs/docs/services/crud-service">CRUD Service</a><button aria-label="Collapse sidebar category &#x27;CRUD Service&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/empowernow_docs/docs/services/crud-service/how-to/migration-guide-visual-designer">How‑to</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets">Secrets Platform</a><button aria-label="Collapse sidebar category &#x27;Secrets Platform&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/executive-overview">Executive overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/architecture-design">Architecture and design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/canonical-uris-and-policy">Canonical URIs and policy model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/providers">Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/security-model">Security model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/observability">Observability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/admin-howto">Admin how‑to</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/developer-guide">Developer guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/api-reference">API reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/troubleshooting-runbooks">Troubleshooting and runbooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/authorization-model-authzen">Secrets authorization model (OpenID AuthZ‑style PDP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/auditing-logging">Auditing and logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/automation-execute-workflows-agents">Automation, /execute workflows, and AI agents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/rotation">Secrets rotation — background and end‑to‑end flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/SECRETS_DEVOPS_GUIDE">Secrets Management DevOps Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/SECRETS_HA_OPENBAO">OpenBao to Production — HA, Load Balancing, and Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/SECRETS_MIGRATION_GUIDE">SECRETS_MIGRATION_GUIDE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/pdp-enrichment">Secrets PDP enrichment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/azure_keyvault_vault">Azure Key Vault</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/empowernow_docs/docs/services/crud-service/secrets/secrets_visual_guide">Secrets visual guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/empowernow_docs/docs/services/crud-service/explanation/checkpointing">Explanations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/category/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/bff">BFF</a><button aria-label="Expand sidebar category &#x27;BFF&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/pdp">PDP</a><button aria-label="Expand sidebar category &#x27;PDP&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/experience">Experience</a><button aria-label="Expand sidebar category &#x27;Experience&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/aria-shield">ARIA Shield</a><button aria-label="Expand sidebar category &#x27;ARIA Shield&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/nowconnect">NowConnect</a><button aria-label="Expand sidebar category &#x27;NowConnect&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/empowernow_docs/docs/services/idp">IdP</a><button aria-label="Expand sidebar category &#x27;IdP&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/personas/faq">Personas</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/marketing">Marketing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/empowernow_docs/docs/enablement/product-review-study-guide">Enablement</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/empowernow_docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Services</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/empowernow_docs/docs/services/crud-service"><span>CRUD Service</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/empowernow_docs/docs/services/crud-service/secrets"><span>Secrets Platform</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Canonical URIs and policy model</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Canonical URIs and policy model</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-canonical-uris">Why Canonical URIs<a href="#why-canonical-uris" class="hash-link" aria-label="Direct link to Why Canonical URIs" title="Direct link to Why Canonical URIs">​</a></h2>
<p>Canonical Secret URIs give us a single, unambiguous way to identify secrets across providers and environments. They let the PEP parse intent, apply tenant/mount guards, ask the PDP for a purpose‑based decision, and then route to the right provider strategy. Because the URI itself carries provider, engine, mount, path, and an optional fragment, the same application code works against OpenBao, HashiCorp Vault, or dev YAML.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="canonical-secret-uris">Canonical Secret URIs<a href="#canonical-secret-uris" class="hash-link" aria-label="Direct link to Canonical Secret URIs" title="Direct link to Canonical Secret URIs">​</a></h2>
<ul>
<li>YAML: <code>yaml://secret/&lt;path&gt;#&lt;key&gt;</code></li>
<li>OpenBao KVv2: <code>openbao+kv2://&lt;mount&gt;/&lt;path&gt;#&lt;key&gt;[?version=N]</code></li>
<li>HashiCorp KVv2: <code>hashicorp+kv2://&lt;mount&gt;/&lt;path&gt;#&lt;key&gt;[?version=N]</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a href="#components" class="hash-link" aria-label="Direct link to Components" title="Direct link to Components">​</a></h3>
<ul>
<li><code>provider[+engine]</code> — which backing store and engine to use (e.g., <code>openbao+kv2</code>, <code>hashicorp+kv2</code>, <code>yaml</code>)</li>
<li><code>mount</code> — top‑level namespace in the provider (e.g., <code>secret</code>)</li>
<li><code>path</code> — nested path segments under the mount (e.g., <code>app/api</code>)</li>
<li><code>fragment</code> — a specific key within a KV map (e.g., <code>#token</code>)</li>
<li><code>version</code> — optional version pin for KVv2 reads (e.g., <code>?version=3</code>)</li>
</ul>
<p>Examples</p>
<ul>
<li>Fragment value: <code>openbao+kv2://secret/app/api#token</code></li>
<li>Whole map at a path: <code>openbao+kv2://secret/app/api</code></li>
<li>Version‑pinned read: <code>openbao+kv2://secret/app/api#token?version=3</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="guards">Guards<a href="#guards" class="hash-link" aria-label="Direct link to Guards" title="Direct link to Guards">​</a></h2>
<ul>
<li>Tenant guard: <code>TENANT_ID</code>, <code>TENANT_ALLOWED_MOUNTS</code></li>
<li>Normalization strips ambiguous forms; invalid URIs yield structured errors</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="policy-model">Policy model<a href="#policy-model" class="hash-link" aria-label="Direct link to Policy model" title="Direct link to Policy model">​</a></h2>
<ul>
<li>Purposes: <code>read</code>, <code>write</code>, <code>delete</code>, <code>undelete</code>, <code>destroy_versions</code>, <code>rotate</code>, <code>read_metadata</code></li>
<li>Batch authorization with mixed required/optional sets</li>
<li>Obligations: TTL, max uses, binding hints</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-purposes-map-to-operations">How purposes map to operations<a href="#how-purposes-map-to-operations" class="hash-link" aria-label="Direct link to How purposes map to operations" title="Direct link to How purposes map to operations">​</a></h3>
<ul>
<li>SDK read via PEP: purpose <code>execute</code> (PDP enforced inside <code>VaultService</code>)</li>
<li>API endpoints map to admin/CRUD purposes (see <code>09-api-reference.md</code>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resource-references">Resource references<a href="#resource-references" class="hash-link" aria-label="Direct link to Resource references" title="Direct link to Resource references">​</a></h2>
<ul>
<li><code>resource_ref = HMAC(tenant_salt, canonical_uri)</code> used in audits (non‑leaky)</li>
</ul>
<p>Why this matters</p>
<ul>
<li>Audits are useful without revealing sensitive paths; the UI/Analytics can still correlate by <code>resource_ref</code>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="defaultdeny-posture-and-lifecycle">Default‑deny posture and lifecycle<a href="#defaultdeny-posture-and-lifecycle" class="hash-link" aria-label="Direct link to Default‑deny posture and lifecycle" title="Direct link to Default‑deny posture and lifecycle">​</a></h2>
<ul>
<li>Policies default to deny unless explicitly allowed for purpose</li>
<li>Owners: Security approves policy changes; periodic reviews (quarterly)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples-and-migration">Examples and migration<a href="#examples-and-migration" class="hash-link" aria-label="Direct link to Examples and migration" title="Direct link to Examples and migration">​</a></h2>
<ul>
<li>With fragment: <code>openbao+kv2://secret/app/api#token</code></li>
<li>Without fragment (path object): <code>openbao+kv2://secret/app/api</code></li>
<li>Version pin: <code>...?version=3</code></li>
<li>Migration: ENV var <code>MY_KEY</code> → pointer <code>MY_KEY_POINTER=openbao+kv2://secret/app#MY_KEY</code></li>
</ul>
<p>Migration tips</p>
<ul>
<li>Keep the same logical names; swap the value for a pointer and use the SDK/API to resolve.</li>
<li>Start with YAML in dev, then replace <code>yaml://</code> with <code>openbao+kv2://</code> for higher environments.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-mistakes">Common mistakes<a href="#common-mistakes" class="hash-link" aria-label="Direct link to Common mistakes" title="Direct link to Common mistakes">​</a></h2>
<ul>
<li>Missing fragment when provider expects KV map → 400</li>
<li>Wrong mount (not in TENANT_ALLOWED_MOUNTS) → 400</li>
<li>Using YAML in prod → blocked by environment guard</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="normalization-rules-what-the-parser-fixes">Normalization rules (what the parser fixes)<a href="#normalization-rules-what-the-parser-fixes" class="hash-link" aria-label="Direct link to Normalization rules (what the parser fixes)" title="Direct link to Normalization rules (what the parser fixes)">​</a></h2>
<ul>
<li>Collapses duplicate slashes, trims whitespace</li>
<li>Lowercases provider/engine scheme</li>
<li>Ensures fragment and version query are in the correct positions</li>
<li>Produces a canonical string that’s stable for HMAC and audits</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="decision-flow-with-canonical-uris">Decision flow with Canonical URIs<a href="#decision-flow-with-canonical-uris" class="hash-link" aria-label="Direct link to Decision flow with Canonical URIs" title="Direct link to Decision flow with Canonical URIs">​</a></h2>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-matrix-qa">Test matrix (QA)<a href="#test-matrix-qa" class="hash-link" aria-label="Direct link to Test matrix (QA)" title="Direct link to Test matrix (QA)">​</a></h2>
<ul>
<li>Valid/invalid URI forms; fuzz path/fragment; ensure normalization is idempotent</li>
<li>Purposes map to expected provider actions and responses</li>
</ul>
<hr>
<p>See also</p>
<ul>
<li>Authorization model and purposes: <code>./11-authorization-model-authzen.md</code></li>
<li>PDP enrichment (exact context fields): <code>./SECRETS_PDP_ENRICHMENT.md</code></li>
<li>Providers and capabilities: <code>./04-providers.md</code></li>
<li>Security model (binding/anti‑replay): <code>./05-security-model.md</code></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/crud-service/secrets/03-canonical-uris-and-policy.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/empowernow_docs/docs/services/crud-service/secrets/architecture-design"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Architecture and design</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/empowernow_docs/docs/services/crud-service/secrets/providers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Providers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-canonical-uris" class="table-of-contents__link toc-highlight">Why Canonical URIs</a></li><li><a href="#canonical-secret-uris" class="table-of-contents__link toc-highlight">Canonical Secret URIs</a><ul><li><a href="#components" class="table-of-contents__link toc-highlight">Components</a></li></ul></li><li><a href="#guards" class="table-of-contents__link toc-highlight">Guards</a></li><li><a href="#policy-model" class="table-of-contents__link toc-highlight">Policy model</a><ul><li><a href="#how-purposes-map-to-operations" class="table-of-contents__link toc-highlight">How purposes map to operations</a></li></ul></li><li><a href="#resource-references" class="table-of-contents__link toc-highlight">Resource references</a></li><li><a href="#defaultdeny-posture-and-lifecycle" class="table-of-contents__link toc-highlight">Default‑deny posture and lifecycle</a></li><li><a href="#examples-and-migration" class="table-of-contents__link toc-highlight">Examples and migration</a></li><li><a href="#common-mistakes" class="table-of-contents__link toc-highlight">Common mistakes</a></li><li><a href="#normalization-rules-what-the-parser-fixes" class="table-of-contents__link toc-highlight">Normalization rules (what the parser fixes)</a></li><li><a href="#decision-flow-with-canonical-uris" class="table-of-contents__link toc-highlight">Decision flow with Canonical URIs</a></li><li><a href="#test-matrix-qa" class="table-of-contents__link toc-highlight">Test matrix (QA)</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/intro">Getting Started</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Marketing</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/solutions">Solutions</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/pricing">Pricing</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/products">Products</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/trust">Trust</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/resources">Resources</a></li><li class="footer__item"><a class="footer__link-item" href="/empowernow_docs/docs/website_copy/company">Company</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/empowerID/empowernow_docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 EmpowerNow. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>