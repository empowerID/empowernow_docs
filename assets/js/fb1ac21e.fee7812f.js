"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[5184],{28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>o});var i=r(96540);const t={},s=i.createContext(t);function c(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(s.Provider,{value:n},e.children)}},51873:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"services/crud-service/explanation/secrets-executive-overview","title":"Secrets enforcement (PEP/PDP) \u2014 Executive overview","description":"Central policy enforcement for secrets with grants, canonical URIs, and non\u2011leaky audits. Fail\u2011closed by default with minimal developer burden.","source":"@site/docs/services/crud-service/explanation/secrets-executive-overview.md","sourceDirName":"services/crud-service/explanation","slug":"/services/crud-service/explanation/secrets-executive-overview","permalink":"/empowernow_docs/docs/services/crud-service/explanation/secrets-executive-overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/crud-service/explanation/secrets-executive-overview.md","tags":[],"version":"current","frontMatter":{"title":"Secrets enforcement (PEP/PDP) \u2014 Executive overview","description":"Central policy enforcement for secrets with grants, canonical URIs, and non\u2011leaky audits. Fail\u2011closed by default with minimal developer burden."},"sidebar":"tutorialSidebar","previous":{"title":"NowConnect + CRUD reliability","permalink":"/empowernow_docs/docs/services/crud-service/explanation/nowconnect-crud-reliability-enhancements"},"next":{"title":"security","permalink":"/empowernow_docs/docs/services/crud-service/explanation/security"}}');var t=r(74848),s=r(28453);const c={title:"Secrets enforcement (PEP/PDP) \u2014 Executive overview",description:"Central policy enforcement for secrets with grants, canonical URIs, and non\u2011leaky audits. Fail\u2011closed by default with minimal developer burden."},o=void 0,a={},l=[{value:"Review outcome",id:"review-outcome",level:3},{value:"Executive overview (for CISO &amp; Product)",id:"executive-overview-for-ciso--product",level:3},{value:"Architecture (high level)",id:"architecture-high-level",level:3},{value:"Request flow (simplified)",id:"request-flow-simplified",level:3},{value:"What we\u2019re adopting (tightened and actionable)",id:"what-were-adopting-tightened-and-actionable",level:3},{value:"Where to go next",id:"where-to-go-next",level:3}];function d(e){const n={code:"code",h3:"h3",li:"li",mermaid:"mermaid",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"review-outcome",children:"Review outcome"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Most feedback is excellent and fits our \u201cuse, not read\u201d and thin\u2011waist goals. We\u2019re incorporating it with clarifications to keep the model simple now and extensible later."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"executive-overview-for-ciso--product",children:"Executive overview (for CISO & Product)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Central policy enforcement for secrets (\u201cuse, not read\u201d), with provable controls, clean operations, and minimal developer burden."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"What\u2019s enforced"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Canonical Secret URIs with tenant guards and strict validation"}),"\n",(0,t.jsx)(n.li,{children:"PDP\u2011backed authorization issuing short\u2011lived, sender\u2011bound grants (DPoP/mTLS + anti\u2011replay)"}),"\n",(0,t.jsx)(n.li,{children:"Provider parity (KVv2 versioning, delete/destroy types; dynamic DB leases)"}),"\n",(0,t.jsx)(n.li,{children:"Egress \u201csecret slots\u201d that prevent leaks across logs/metrics/responses"}),"\n",(0,t.jsxs)(n.li,{children:["Audits with non\u2011leaky identifiers (",(0,t.jsx)(n.code,{children:"resource_ref"}),"), decision correlation, and sampling"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Outcomes"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Fail\u2011closed defaults with break\u2011glass out of band"}),"\n",(0,t.jsx)(n.li,{children:"Low latency on grant hits; clear runbooks; phased rollout with safe switches"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"architecture-high-level",children:"Architecture (high level)"}),"\n",(0,t.jsx)(n.mermaid,{value:'graph LR\r\n  Client["Client (/execute, Workflows)"] --\x3e CRUD["CRUDService"]\r\n  CRUD --\x3e PEP["VaultService (PEP)"]\r\n  PEP --\x3e PDP["SecretPolicyService (PDP)"]\r\n  PEP --\x3e CACHE["Grants / Anti\u2011replay / Negative cache"]\r\n  PEP --\x3e PROV{"Providers"}\r\n  PROV --\x3e OB["OpenBao (KVv2)"]\r\n  PROV --\x3e HV["HashiCorp Vault (KVv2)"]\r\n  PROV --\x3e DBC["DB Credentials (enc/lease)"]\r\n  PROV --\x3e FILE["File/CSI (dev)"]\r\n  PEP --\x3e AUD["Audit (Kafka)"]\r\n  CRUD --\x3e CONN["Connectors (REST/LDAP/ODBC/SSH)"]\r\n  CONN -. uses .-> SLOTS["Egress Secret Slots (redacted)"]\r\n  PDP -- Grants/Obligations --\x3e PEP'}),"\n",(0,t.jsx)(n.h3,{id:"request-flow-simplified",children:"Request flow (simplified)"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\r\n  participant C as Client\r\n  participant X as /execute\r\n  participant V as VaultService (PEP)\r\n  participant S as SecretPolicyService (PDP)\r\n  participant P as Provider (KVv2/DB)\r\n  participant A as Audit\r\n\r\n  C->>X: Invoke action (system/workflow)\r\n  X->>V: Resolve secret pointers (+ExecutionContext)\r\n  V->>S: Batch authorize (aud, cnf, jti)\r\n  S--\x3e>V: Grants (ttl, max_uses, obligations)\r\n  V->>P: Fetch secret\r\n  P--\x3e>V: Secret with metadata and lease\r\n  V->>A: Audit (resource_ref, decision, kv_version, lease)\r\n  V--\x3e>X: Return secret slot (redacted)\r\n  X--\x3e>C: Success (no plaintext values)"}),"\n",(0,t.jsx)(n.h3,{id:"what-were-adopting-tightened-and-actionable",children:"What we\u2019re adopting (tightened and actionable)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Canonical URIs"})," with strict normalization, tenant guards, and explicit error codes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"v1 ARN"})," mapping plus a short HMAC\u2011based ",(0,t.jsx)(n.code,{children:"resource_ref"})," for audit/cache."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"PEP + Grants"})," with sender\u2011binding (DPoP/mTLS), ",(0,t.jsx)(n.code,{children:"jti"})," anti\u2011replay, atomic use\u2011count semantics, negative caching, and fail\u2011closed on PDP outage (except break\u2011glass)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Batch PDP"})," semantics for ",(0,t.jsx)(n.code,{children:"/execute"})," and workflows; revalidation rules."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Provider edge cases"})," (KVv2 pinned version, delete/destroy types; DB engine leases/renew/revoke)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Egress guard"})," via secret \u201cslots\u201d that block leakage and enforce redaction."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Audit enrichment"})," (non\u2011leaky), safer defaults, and security\u2011focused tests."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"where-to-go-next",children:"Where to go next"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Canonical URI grammar and error codes: ./../how-to/secrets-canonical-uris.md"}),"\n",(0,t.jsx)(n.li,{children:"Audits and metrics schema: ./../how-to/audits-and-metrics.md"}),"\n",(0,t.jsx)(n.li,{children:"YAML Vault Provider for local dev: ./../how-to/yaml-vault-provider.md"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);