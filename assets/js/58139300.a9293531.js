"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[5491],{28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var t=s(96540);const i={},r=t.createContext(i);function c(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(r.Provider,{value:n},e.children)}},72285:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"services/crud-service/secrets/auditing-logging","title":"Auditing and logging","description":"What we audit for secrets, how events flow to Kafka and Analytics, and how UIs consume them","source":"@site/docs/services/crud-service/secrets/12-auditing-logging.md","sourceDirName":"services/crud-service/secrets","slug":"/services/crud-service/secrets/auditing-logging","permalink":"/empowernow_docs/docs/services/crud-service/secrets/auditing-logging","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/crud-service/secrets/12-auditing-logging.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"title":"Auditing and logging","description":"What we audit for secrets, how events flow to Kafka and Analytics, and how UIs consume them"},"sidebar":"tutorialSidebar","previous":{"title":"Secrets authorization model (OpenID AuthZ\u2011style PDP)","permalink":"/empowernow_docs/docs/services/crud-service/secrets/authorization-model-authzen"},"next":{"title":"Automation, /execute workflows, and AI agents","permalink":"/empowernow_docs/docs/services/crud-service/secrets/automation-execute-workflows-agents"}}');var i=s(74848),r=s(28453);const c={title:"Auditing and logging",description:"What we audit for secrets, how events flow to Kafka and Analytics, and how UIs consume them"},a=void 0,o={},d=[{value:"What we audit",id:"what-we-audit",level:2},{value:"How events are produced",id:"how-events-are-produced",level:2},{value:"Pipeline to Analytics and ClickHouse",id:"pipeline-to-analytics-and-clickhouse",level:2},{value:"Logging",id:"logging",level:2}];function l(e){const n={code:"code",h2:"h2",li:"li",mermaid:"mermaid",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"what-we-audit",children:"What we audit"}),"\n",(0,i.jsx)(n.p,{children:"Actions recorded as structured events for secrets operations:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Reads via PEP (VaultService) and Secrets API"}),"\n",(0,i.jsx)(n.li,{children:"Create/update (set), delete (soft), rotate"}),"\n",(0,i.jsx)(n.li,{children:"Undelete, destroy versions (KVv2)"}),"\n",(0,i.jsx)(n.li,{children:"Metadata listing and key enumeration (metadata access)"}),"\n",(0,i.jsx)(n.li,{children:"Bulk operations (per\u2011op events)"}),"\n",(0,i.jsx)(n.li,{children:"Copy/move (source read + destination write)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Event content (high level):"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Correlation identifiers (correlation_id, optional trace_id/span_id)"}),"\n",(0,i.jsx)(n.li,{children:"Subject and optional user context (when available)"}),"\n",(0,i.jsxs)(n.li,{children:["Non\u2011leaky ",(0,i.jsx)(n.code,{children:"resource_ref"})," (HMAC of canonical URI when ",(0,i.jsx)(n.code,{children:"TENANT_SALT"})," is set)"]}),"\n",(0,i.jsx)(n.li,{children:"Event type, effect (success/failure), timestamp, and provider type"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"how-events-are-produced",children:"How events are produced"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The PEP and Secrets API publish events via the Kafka producer."}),"\n",(0,i.jsxs)(n.li,{children:["Topics include functional and audit streams (for example: ",(0,i.jsx)(n.code,{children:"crud.secrets"}),", ",(0,i.jsx)(n.code,{children:"crud.secrets.audit"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Topic names are prefixed by ",(0,i.jsx)(n.code,{children:"KAFKA_TOPIC_PREFIX"})," (default: ",(0,i.jsx)(n.code,{children:"crud"}),")."]}),"\n",(0,i.jsx)(n.li,{children:"Values such as secret payloads are redacted before emission."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See also: ",(0,i.jsx)(n.code,{children:"../reference/secrets-api.md"})," and the broader Kafka events overview in ",(0,i.jsx)(n.code,{children:"../../crud-service/reference/kafka-events.md"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"pipeline-to-analytics-and-clickhouse",children:"Pipeline to Analytics and ClickHouse"}),"\n",(0,i.jsx)(n.p,{children:"At a high level, Analytics consumes the Kafka streams and persists events to ClickHouse. Analytics exposes API endpoints used by our front\u2011end interfaces to render dashboards and reports."}),"\n",(0,i.jsx)(n.mermaid,{value:"flowchart LR\r\n  PEP[VaultService / Secrets API<br/>event producer] --\x3e|Kafka| K[(Kafka topics)]\r\n  K --\x3e AC[Analytics consumer]\r\n  AC --\x3e CH[(ClickHouse)]\r\n  CH --\x3e AAPI[Analytics API]\r\n  AAPI --\x3e UIs[Front\u2011end UIs]"}),"\n",(0,i.jsx)(n.p,{children:"Notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Kafka is the transport; retention and ACLs are configured at the platform level."}),"\n",(0,i.jsx)(n.li,{children:"ClickHouse holds the analytical store queried by Analytics APIs."}),"\n",(0,i.jsx)(n.li,{children:"Front\u2011end UIs call Analytics APIs to render tables, charts, and timelines."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"logging",children:"Logging"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Logs are structured and redact sensitive values."}),"\n",(0,i.jsx)(n.li,{children:"Correlation IDs connect logs, traces, and audit events for investigations."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);