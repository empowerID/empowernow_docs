"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[5462],{28453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>c});var r=t(96540);const n={},i=r.createContext(n);function o(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(i.Provider,{value:s},e.children)}},76817:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"services/bff/testers/guide","title":"QA Test Execution Guide (Compose)","description":"This guide summarizes the verified steps to stand up the authzen4 compose stack and execute critical BFF tests.","source":"@site/docs/services/bff/testers/guide.md","sourceDirName":"services/bff/testers","slug":"/services/bff/testers/guide","permalink":"/empowernow_docs/docs/services/bff/testers/guide","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/bff/testers/guide.md","tags":[],"version":"current","frontMatter":{"title":"QA Test Execution Guide (Compose)"}}');var n=t(74848),i=t(28453);const o={title:"QA Test Execution Guide (Compose)"},c=void 0,a={},l=[{value:"Prereqs",id:"prereqs",level:2},{value:"Bring up stack",id:"bring-up-stack",level:2},{value:"URL model (verified)",id:"url-model-verified",level:2},{value:"Critical tests (from BFF repo)",id:"critical-tests-from-bff-repo",level:2},{value:"Troubleshooting quick refs",id:"troubleshooting-quick-refs",level:2}];function d(e){const s={code:"code",h2:"h2",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.p,{children:"This guide summarizes the verified steps to stand up the authzen4 compose stack and execute critical BFF tests."}),"\n",(0,n.jsx)(s.h2,{id:"prereqs",children:"Prereqs"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Docker & Compose installed"}),"\n",(0,n.jsxs)(s.li,{children:["Hosts file maps local domains to 127.0.0.1:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"authn|authz|automate|api|idp|traefik.ocg.labs.empowernow.ai"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.li,{children:"Test credentials available (dedicated test account)"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"bring-up-stack",children:"Bring up stack"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"cd CRUDService\r\ndocker-compose -f docker-compose-authzen4.yml up -d\n"})}),"\n",(0,n.jsx)(s.p,{children:"Verify core health:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"docker-compose -f docker-compose-authzen4.yml ps\r\ncurl -f http://localhost:8000/health || echo FAIL\r\ncurl -f http://localhost:8080/ping || echo FAIL\n"})}),"\n",(0,n.jsx)(s.h2,{id:"url-model-verified",children:"URL model (verified)"}),"\n",(0,n.jsx)(s.mermaid,{value:"graph TD\r\nA[Browser / Tests] --\x3e|hosts file| B[Traefik :80/:443]\r\nB --\x3e|Host routing| C[BFF API :8000]\r\nB --\x3e D[Static SPAs]\r\nC --\x3e E[IdP :8002]\r\nC --\x3e F[CRUD :8000]\r\nC --\x3e G[PDP :8001]\r\nC --\x3e H[Redis :6379]"}),"\n",(0,n.jsx)(s.h2,{id:"critical-tests-from-bff-repo",children:"Critical tests (from BFF repo)"}),"\n",(0,n.jsxs)(s.p,{children:["Run in ",(0,n.jsx)(s.code,{children:"ms_bff_spike/ms_bff"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"python verify_tests_created.py\r\npython -m pytest tests/integration/test_traefik_forwardauth.py::test_integration_traefik_forwardauth_full_flow -v -s\r\npython -m pytest tests/integration/test_traefik_middleware_config.py::test_integration_traefik_middleware_chain -v -s\r\npython -m pytest tests/e2e/test_real_user_workflows.py::test_real_user_workflow_integration -v -s\n"})}),"\n",(0,n.jsx)(s.p,{children:"Run complete suite:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"python -m pytest \\\r\n  tests/integration/test_traefik_forwardauth.py \\\r\n  tests/integration/test_traefik_middleware_config.py \\\r\n  tests/e2e/test_real_user_workflows.py -v -s\n"})}),"\n",(0,n.jsx)(s.h2,{id:"troubleshooting-quick-refs",children:"Troubleshooting quick refs"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Inspect logs:"}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"docker-compose -f ../CRUDService/docker-compose-authzen4.yml logs -f bff_app\n"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Validate ForwardAuth endpoint (unauthenticated):"}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"curl http://localhost:8000/auth/forward  # expect 401/403\n"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Common issues: missing hosts entries, credentials not set, Traefik dynamic config not pointing to ",(0,n.jsx)(s.code,{children:"/auth/forward"}),"."]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);