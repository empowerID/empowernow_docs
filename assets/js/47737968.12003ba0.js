"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[7712],{26489:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"services/bff/how-to/traefik-forwardauth","title":"Traefik ForwardAuth","description":"Verified Traefik config for BFF authentication.","source":"@site/docs/services/bff/how-to/traefik-forwardauth.md","sourceDirName":"services/bff/how-to","slug":"/services/bff/how-to/traefik-forwardauth","permalink":"/empowernow_docs/docs/services/bff/how-to/traefik-forwardauth","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/bff/how-to/traefik-forwardauth.md","tags":[],"version":"current","frontMatter":{"title":"Traefik ForwardAuth"},"sidebar":"tutorialSidebar","previous":{"title":"Tune Token Refresh Thresholds","permalink":"/empowernow_docs/docs/services/bff/how-to/token-refresh-tuning"},"next":{"title":"Tune CB/cache","permalink":"/empowernow_docs/docs/services/bff/how-to/tune-legacy-circuit-cache"}}');var s=t(74848),o=t(28453);const i={title:"Traefik ForwardAuth"},a=void 0,c={},d=[];function l(e){const r={code:"code",li:"li",mermaid:"mermaid",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.p,{children:"Verified Traefik config for BFF authentication."}),"\n",(0,s.jsx)(r.mermaid,{value:"flowchart TB\r\n  subgraph Edge\r\n    TR[Traefik Router]\r\n    FA[ForwardAuth Middleware]\r\n    RL[RateLimit]\r\n    SH[Security Headers]\r\n  end\r\n  subgraph BFF\r\n    V[/auth/verify/]\r\n  end\r\n  TR --\x3e FA --\x3e V\r\n  TR --\x3e RL\r\n  TR --\x3e SH"}),"\n",(0,s.jsxs)(r.p,{children:["Key fields (from ",(0,s.jsx)(r.code,{children:"k8s/ingress.yaml"}),"):"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Middleware (CRD):","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"forwardAuth.address: http://bff-service.empowernow.svc.cluster.local:8000/auth/verify"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"forwardAuth.trustForwardHeader: true"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:'forwardAuth.authResponseHeaders: ["X-User-ID", "X-Session-ID", "X-Auth-Time", ...]'})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:'forwardAuth.authRequestHeaders: ["Cookie", "User-Agent", "X-Forwarded-For", ...]'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.li,{children:"Ingress annotations link the ForwardAuth and rate limit middlewares"}),"\n",(0,s.jsx)(r.li,{children:"TLS via cert-manager issuer"}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Notes:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Use the alias ",(0,s.jsx)(r.code,{children:"/auth/forward"})," if configured; code provides ",(0,s.jsx)(r.code,{children:"/auth/verify"})," endpoint."]}),"\n",(0,s.jsx)(r.li,{children:"Don\u2019t apply ForwardAuth to static SPA assets."}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>a});var n=t(96540);const s={},o=n.createContext(s);function i(e){const r=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(o.Provider,{value:r},e.children)}}}]);