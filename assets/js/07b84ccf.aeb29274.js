"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[2598],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var s=r(96540);const c={},i=s.createContext(c);function t(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),s.createElement(i.Provider,{value:n},e.children)}},44162:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"source_content/connector_guide","title":"connector_guide","description":"Connector developer guide","source":"@site/docs/source_content/connector_guide.md","sourceDirName":"source_content","slug":"/source_content/connector_guide","permalink":"/empowernow_docs/docs/source_content/connector_guide","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/source_content/connector_guide.md","tags":[],"version":"current","frontMatter":{}}');var c=r(74848),i=r(28453);const t={},d=void 0,o={},l=[{value:"Connector developer guide",id:"connector-developer-guide",level:2},{value:"Architecture",id:"architecture",level:3},{value:"Common configuration",id:"common-configuration",level:3},{value:"LDAP",id:"ldap",level:3},{value:"REST",id:"rest",level:3},{value:"SCIM 2.0",id:"scim-20",level:3},{value:"ODBC/SQL",id:"odbcsql",level:3},{value:"Azure Graph",id:"azure-graph",level:3},{value:"Systems registry example",id:"systems-registry-example",level:3},{value:"Secrets",id:"secrets",level:3},{value:"Observability",id:"observability",level:3}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h2,{id:"connector-developer-guide",children:"Connector developer guide"}),"\n",(0,c.jsx)(n.p,{children:"This guide covers building and configuring VDS connectors, the shared adapter layer, and example configs for LDAP, REST, SCIM, ODBC, and Azure Graph."}),"\n",(0,c.jsxs)(n.p,{children:["See also: ",(0,c.jsx)(n.a,{href:"/empowernow_docs/docs/source_content/virtualization_phase2",children:"Virtualization Phase 2 \u2014 Data Shaping, Merging, and Projection"}),"."]}),"\n",(0,c.jsx)(n.h3,{id:"architecture",children:"Architecture"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Provider interface: ",(0,c.jsx)(n.code,{children:"vds.connectors.base.Provider"})," exposes ",(0,c.jsx)(n.code,{children:"async search(query: ProviderQuery) -> (rows, next_cursor)"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Row shape: ",(0,c.jsx)(n.code,{children:"{ subject: str, id: str }"}),", ordered by ",(0,c.jsx)(n.code,{children:"(subject.casefold, id)"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Registry: ",(0,c.jsx)(n.code,{children:"vds.connectors.registry.ProviderRegistry"})," maps types (ldap, rest, scim, odbc, azure) to provider classes; can build from a systems YAML."]}),"\n",(0,c.jsxs)(n.li,{children:["Secrets: ",(0,c.jsx)(n.code,{children:"EnvSecretsProvider"})," by default; ",(0,c.jsx)(n.code,{children:"VaultSecretsProvider"})," optionally reads HashiCorp Vault KV v2."]}),"\n",(0,c.jsxs)(n.li,{children:["Adapter: ",(0,c.jsx)(n.code,{children:"vds.connectors.adapter"})," provides ",(0,c.jsx)(n.code,{children:"map_exception"}),", templating helpers (",(0,c.jsx)(n.code,{children:"render_endpoint"}),", ",(0,c.jsx)(n.code,{children:"render_body_or_params"}),"), and a ",(0,c.jsx)(n.code,{children:"SecretsFacade"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Observability: ",(0,c.jsx)(n.code,{children:"vds.observability.tracing.span"})," emits timing; ",(0,c.jsx)(n.code,{children:"vds.observability.metrics.metrics"})," records provider latency and retry counters."]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"common-configuration",children:"Common configuration"}),"\n",(0,c.jsx)(n.p,{children:"All providers accept a CRUD-like shape:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:'server: { base_url: "...", token_url: "...", use_ssl: false }\ncredentials: { client_id: "...", client_secret: "...", bearer_token: "..." }\nmapping: { subject_attr: "...", id_attr: "..." }\nretry: { max_attempts: 3, backoff_base: 0.2, backoff_factor: 2.0 }\n'})}),"\n",(0,c.jsx)(n.h3,{id:"ldap",children:"LDAP"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Options: ",(0,c.jsx)(n.code,{children:"server.base_url"}),", ",(0,c.jsx)(n.code,{children:"server.port"}),", ",(0,c.jsx)(n.code,{children:"server.use_ssl"}),", ",(0,c.jsx)(n.code,{children:"server.base_dn"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Credentials: ",(0,c.jsx)(n.code,{children:"credentials.username"}),", ",(0,c.jsx)(n.code,{children:"credentials.password"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Advanced: ",(0,c.jsx)(n.code,{children:"alias_deref: never|searching|finding|always"}),", ",(0,c.jsx)(n.code,{children:"referrals: true|false"}),", ",(0,c.jsx)(n.code,{children:'sort_keys: ["cn", "sn"]'}),", ",(0,c.jsx)(n.code,{children:"vlv: {before: 0, after: 49}"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Pooling: ",(0,c.jsx)(n.code,{children:"pool: { min: 0, max: 4 }"})," and optional ",(0,c.jsx)(n.code,{children:"client_factory"})," for tests."]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:'type: ldap\nserver: { base_url: addomain, port: 636, use_ssl: true, base_dn: "DC=addomain,DC=com" }\ncredentials: { username: "addomain\\\\svc", password: "..." }\nmapping: { subject_attr: sAMAccountName, id_attr: objectGUID }\nalias_deref: always\nreferrals: true\nsort_keys: ["sAMAccountName"]\nvlv: { before: 0, after: 199 }\npool: { min: 0, max: 4 }\n'})}),"\n",(0,c.jsx)(n.h3,{id:"rest",children:"REST"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Token: optional client-credentials flow using ",(0,c.jsx)(n.code,{children:"server.token_url"})," + ",(0,c.jsx)(n.code,{children:"credentials.client_id/secret/audience"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Retries: respects ",(0,c.jsx)(n.code,{children:"Retry-After"})," and vendor variants."]}),"\n",(0,c.jsxs)(n.li,{children:["Actions: ",(0,c.jsx)(n.code,{children:"perform_action"})," with templated ",(0,c.jsx)(n.code,{children:"endpoint"}),", ",(0,c.jsx)(n.code,{children:"params"}),", ",(0,c.jsx)(n.code,{children:"body"}),", header overrides, expected outcomes, and pagination extraction."]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:'type: rest\nserver: { base_url: "https://api" , token_url: "https://auth/oauth/token" }\ncredentials: { client_id: "...", client_secret: "...", audience: "https://api" }\nmapping: { subject_attr: email, id_attr: user_id }\n'})}),"\n",(0,c.jsx)(n.h3,{id:"scim-20",children:"SCIM 2.0"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Bearer token header or OAuth."}),"\n",(0,c.jsxs)(n.li,{children:["Paging: ",(0,c.jsx)(n.code,{children:"startIndex"}),"/",(0,c.jsx)(n.code,{children:"count"}),"; filter passthrough for simple ",(0,c.jsx)(n.code,{children:"eq"})," mapping."]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:'type: scim\nserver: { base_url: "https://scim.example/v2" }\ncredentials: { bearer_token: "..." }\nmapping: { subject_attr: userName, id_attr: id }\n'})}),"\n",(0,c.jsx)(n.h3,{id:"odbcsql",children:"ODBC/SQL"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["DSN: ",(0,c.jsx)(n.code,{children:"dsn"})," or engine URL; tests can use ",(0,c.jsx)(n.code,{children:"rows"})," for in-memory mode."]}),"\n",(0,c.jsxs)(n.li,{children:["Ordering: always by ",(0,c.jsx)(n.code,{children:"lower(subject), id"}),"."]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:'type: odbc\ndsn: "Driver=ODBC Driver 18 for SQL Server;Server=tcp:db,1433;Database=app;..."\nsubject_column: subject\nid_column: id\n'})}),"\n",(0,c.jsx)(n.h3,{id:"azure-graph",children:"Azure Graph"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Base URL default: ",(0,c.jsx)(n.code,{children:"https://graph.microsoft.com/v1.0"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Token: AAD v2.0 client credentials with ",(0,c.jsx)(n.code,{children:"scope: https://graph.microsoft.com/.default"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Features: ",(0,c.jsx)(n.code,{children:"$batch"}),", ",(0,c.jsx)(n.code,{children:"@odata.nextLink"}),", optional ",(0,c.jsx)(n.code,{children:"delta"})," flow."]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:'type: azure\nserver: { base_url: "https://graph.microsoft.com/v1.0", token_url: "https://login.microsoftonline.com/<tenant>/oauth2/v2.0/token" }\ncredentials: { client_id: "...", client_secret: "...", scope: "https://graph.microsoft.com/.default" }\nmapping: { subject_attr: userPrincipalName, id_attr: id }\ndelta: true\n'})}),"\n",(0,c.jsx)(n.h3,{id:"systems-registry-example",children:"Systems registry example"}),"\n",(0,c.jsxs)(n.p,{children:["You can define systems in a YAML and build the registry using ",(0,c.jsx)(n.code,{children:"ProviderRegistry.from_systems_config(...)"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:'systems:\n  addomain:\n    type: ldap\n    config:\n      server: { base_url: addomain, port: 636, use_ssl: true, base_dn: "DC=addomain,DC=com" }\n      credentials: { username: "addomain\\\\svc", password: "..." }\n      mapping: { subject_attr: sAMAccountName, id_attr: objectGUID }\n  auth_api:\n    type: rest\n    config:\n      server: { base_url: "https://api", token_url: "https://auth/oauth/token" }\n      credentials: { client_id: "id", client_secret: "secret", audience: "https://api" }\n  scim_dir:\n    type: scim\n    config:\n      server: { base_url: "https://scim.example/v2" }\n      credentials: { bearer_token: "t" }\n  hr_db:\n    type: odbc\n    config:\n      dsn: "Driver=ODBC Driver;Server=db;Database=app;..."\n  azure_tenant:\n    type: azure\n    config:\n      server: { base_url: "https://graph.microsoft.com/v1.0" }\n      credentials: { client_id: "id", client_secret: "secret" }\n'})}),"\n",(0,c.jsx)(n.h3,{id:"secrets",children:"Secrets"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Default: ",(0,c.jsx)(n.code,{children:"EnvSecretsProvider"})," reads environment variables."]}),"\n",(0,c.jsxs)(n.li,{children:["Optional: ",(0,c.jsx)(n.code,{children:"VaultSecretsProvider"})," (HashiCorp KV v2): ",(0,c.jsx)(n.code,{children:"base_url"}),", ",(0,c.jsx)(n.code,{children:"token"}),", ",(0,c.jsx)(n.code,{children:"mount"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:["Secret names may include ",(0,c.jsx)(n.code,{children:"#key"})," selector, e.g. ",(0,c.jsx)(n.code,{children:"app/db#password"}),"."]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"observability",children:"Observability"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Spans: ",(0,c.jsx)(n.code,{children:"provider.*"}),", ",(0,c.jsx)(n.code,{children:"aggregator.*"}),", ",(0,c.jsx)(n.code,{children:"mapping.*"})," emit timing."]}),"\n",(0,c.jsx)(n.li,{children:"Metrics: provider latency list, provider retry counter, aggregator/mapping latency, cookie oversize, config reload, mapping version."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}}}]);