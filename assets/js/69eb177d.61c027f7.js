"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[4940],{3933:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"services/experience/security-compliance","title":"Security & Compliance Addendum (Experience)","description":"Threat model, control crosswalk, event dictionary, enforcement playbooks, signing/provenance, rate limits, and Trusted Types roadmap.","source":"@site/docs/services/experience/security-compliance.md","sourceDirName":"services/experience","slug":"/services/experience/security-compliance","permalink":"/empowernow_docs/docs/services/experience/security-compliance","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/experience/security-compliance.md","tags":[],"version":"current","frontMatter":{"title":"Security & Compliance Addendum (Experience)","sidebar_label":"Security & Compliance","description":"Threat model, control crosswalk, event dictionary, enforcement playbooks, signing/provenance, rate limits, and Trusted Types roadmap."},"sidebar":"tutorialSidebar","previous":{"title":"Plugins Quickstart","permalink":"/empowernow_docs/docs/services/experience/quickstart"},"next":{"title":"Plugins Security Reference","permalink":"/empowernow_docs/docs/services/experience/security-reference"}}');var r=i(74848),t=i(28453);const o={title:"Security & Compliance Addendum (Experience)",sidebar_label:"Security & Compliance",description:"Threat model, control crosswalk, event dictionary, enforcement playbooks, signing/provenance, rate limits, and Trusted Types roadmap."},l=void 0,c={},a=[{value:"Threat model (STRIDE summary)",id:"threat-model-stride-summary",level:2},{value:"Control crosswalk (indicative)",id:"control-crosswalk-indicative",level:2},{value:"Event dictionary (minimum)",id:"event-dictionary-minimum",level:2},{value:"Enforcement playbooks",id:"enforcement-playbooks",level:2},{value:"Signing &amp; provenance (policy)",id:"signing--provenance-policy",level:2},{value:"Rate limiting &amp; quotas (defaults)",id:"rate-limiting--quotas-defaults",level:2},{value:"Trusted Types roadmap",id:"trusted-types-roadmap",level:2}];function d(e){const n={code:"code",h2:"h2",li:"li",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"threat-model-stride-summary",children:"Threat model (STRIDE summary)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Spoofing: mitigated by session\u2011only auth (httpOnly, Secure, SameSite); PDP subject normalization; ",(0,r.jsx)(n.code,{children:"X-Plugin-Id"})," required"]}),"\n",(0,r.jsxs)(n.li,{children:["Tampering: bundles are same\u2011origin and served read\u2011only from ",(0,r.jsx)(n.code,{children:"/app/plugins"}),"; optional integrity hash (",(0,r.jsx)(n.code,{children:"sha256"}),"); allow\u2011lists compiled and normalized"]}),"\n",(0,r.jsx)(n.li,{children:"Repudiation: CAEP\u2011style events + OTEL spans; correlation IDs; decision logs in PDP"}),"\n",(0,r.jsx)(n.li,{children:"Information disclosure: PDP pre\u2011gating; BFF allow\u2011lists; no tokens in browser; strict CSP; CORP same\u2011origin"}),"\n",(0,r.jsx)(n.li,{children:"DoS: rate limiting per plugin; SSE prefixes gated; quarantine kill switch"}),"\n",(0,r.jsx)(n.li,{children:"Elevation of privilege: AuthZEN decisions on every affordance; per\u2011plugin allow\u2011lists; subject isolation via provider\u2011namespaced ARNs"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"control-crosswalk-indicative",children:"Control crosswalk (indicative)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"NIST 800\u201153: AC\u20113 (PDP at BFF), AC\u20116 (least privilege: per\u2011plugin allow\u2011lists), AU\u20112/12 (events/logs), SC\u20118 (TLS), SC\u201123 (session authenticity), SI\u201110 (input validation via path templates)"}),"\n",(0,r.jsx)(n.li,{children:"SOC2 CC6/CC7: logical access controls (PDP), change management (plugins.yaml PRs; hot reload), monitoring (metrics/logs), incident response (quarantine playbook)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"event-dictionary-minimum",children:"Event dictionary (minimum)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["PluginServed: ",(0,r.jsx)(n.code,{children:"{tenant, plugin_id, version, etag, bytes, latency_ms}"})]}),"\n",(0,r.jsxs)(n.li,{children:["PluginDenied: ",(0,r.jsx)(n.code,{children:"{tenant, plugin_id, reason: allowlist|quarantine|integrity, path, method}"})]}),"\n",(0,r.jsxs)(n.li,{children:["QuarantineChanged: ",(0,r.jsx)(n.code,{children:"{tenant, plugin_id, status: on|off, actor}"})]}),"\n",(0,r.jsxs)(n.li,{children:["PDPDecision: ",(0,r.jsx)(n.code,{children:"{subject, resource, action, decision, obligations, latency_ms}"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Emit as: Kafka events + OTEL spans/attributes. Consider CAEP categories for authz/extension events."}),"\n",(0,r.jsx)(n.h2,{id:"enforcement-playbooks",children:"Enforcement playbooks"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Quarantine: ",(0,r.jsx)(n.code,{children:"POST /api/plugins/quarantine/{id}"})," \u2192 verify blocks; communicate; diagnose; unquarantine when fixed"]}),"\n",(0,r.jsxs)(n.li,{children:["Integrity failure: 409 + ",(0,r.jsx)(n.code,{children:"X-Integrity-Error: 1"})," \u2192 roll back to prior bundle (atomic flip); recompute hash; PR fix"]}),"\n",(0,r.jsxs)(n.li,{children:["Allow\u2011list abuse: 403 + ",(0,r.jsx)(n.code,{children:"X-Allowlist-Violation: 1"})," \u2192 audit calls; adjust templates; add tests; consider rate limit tightening"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"signing--provenance-policy",children:"Signing & provenance (policy)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Today: optional ",(0,r.jsx)(n.code,{children:"bundle.integrity: sha256:<hex>"}),"; recommend enabling in prod"]}),"\n",(0,r.jsx)(n.li,{children:"Roadmap: adopt SLSA\u2011style provenance; sign bundles (e.g., cosign); BFF verification flow: warn\u2011only \u2192 enforce on signature failure"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"rate-limiting--quotas-defaults",children:"Rate limiting & quotas (defaults)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Per\u2011plugin rate limit (API): start 60 RPM, burst 30; adjust per tenant"}),"\n",(0,r.jsx)(n.li,{children:"SSE channels: limit concurrent streams per plugin (e.g., 2)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"trusted-types-roadmap",children:"Trusted Types roadmap"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Current: report\u2011only; configure report endpoint and triage"}),"\n",(0,r.jsxs)(n.li,{children:["Hardened tiers: move to ",(0,r.jsx)(n.code,{children:"require-trusted-types-for 'script'"})," enforce; inventory sinks; publish migration notes"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See also: Ops Runbook ",(0,r.jsx)(n.code,{children:"./ops-runbook"}),", API Reference ",(0,r.jsx)(n.code,{children:"./api-reference"}),", Security Reference ",(0,r.jsx)(n.code,{children:"./security-reference"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(96540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);