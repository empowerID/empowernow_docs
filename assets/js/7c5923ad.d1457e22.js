"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[3029],{22892:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"services/pdp/explanation/application_policy_loading","title":"Application Policy Loading \u2014 Inheritance & Priority","description":"Canonical reference: scopedpolicydesign.md. This doc explains the 5-level inheritance model and load order.","source":"@site/docs/services/pdp/explanation/application_policy_loading.md","sourceDirName":"services/pdp/explanation","slug":"/services/pdp/explanation/application_policy_loading","permalink":"/empowernow_docs/docs/services/pdp/explanation/application_policy_loading","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/pdp/explanation/application_policy_loading.md","tags":[],"version":"current","frontMatter":{}}');var l=i(74848),o=i(28453);const a={},s="Application Policy Loading \u2014 Inheritance & Priority",c={},t=[{value:"Inheritance levels (most specific wins)",id:"inheritance-levels-most-specific-wins",level:2},{value:"Directory structure (example)",id:"directory-structure-example",level:2},{value:"Load order &amp; combination",id:"load-order--combination",level:2},{value:"Conflict resolution examples",id:"conflict-resolution-examples",level:2},{value:"Example 1: Application overrides domain shared",id:"example-1-application-overrides-domain-shared",level:3},{value:"Example 2: Deny-override across levels",id:"example-2-deny-override-across-levels",level:3},{value:"Author guidance",id:"author-guidance",level:2},{value:"Notes",id:"notes",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"application-policy-loading--inheritance--priority",children:"Application Policy Loading \u2014 Inheritance & Priority"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["Canonical reference: ",(0,l.jsx)(n.code,{children:"scoped_policy_design.md"}),". This doc explains the 5-level inheritance model and load order."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"inheritance-levels-most-specific-wins",children:"Inheritance levels (most specific wins)"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"APPLICATION (Level 1)"}),"\n",(0,l.jsx)(n.li,{children:"DOMAIN_ENVIRONMENT (Level 2)"}),"\n",(0,l.jsx)(n.li,{children:"CROSS_ENVIRONMENT (Level 3)"}),"\n",(0,l.jsx)(n.li,{children:"DOMAIN_SHARED (Level 4)"}),"\n",(0,l.jsx)(n.li,{children:"GLOBAL (Level 5)"}),"\n"]}),"\n",(0,l.jsx)(n.mermaid,{value:"flowchart TD\r\n  G[GLOBAL] --\x3e DS[DOMAIN_SHARED]\r\n  DS --\x3e CE[CROSS_ENVIRONMENT]\r\n  CE --\x3e DE[DOMAIN_ENVIRONMENT]\r\n  DE --\x3e APP[APPLICATION]\r\n  classDef lastfill fill:#eef,stroke:#99f,stroke-width:1px\r\n  class APP lastfill"}),"\n",(0,l.jsx)(n.h2,{id:"directory-structure-example",children:"Directory structure (example)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"config/policies/\r\n\u251c\u2500\u2500 global/\r\n\u251c\u2500\u2500 domains/\r\n\u2502   \u2514\u2500\u2500 sharepoint/\r\n\u2502       \u251c\u2500\u2500 shared/\r\n\u2502       \u251c\u2500\u2500 cross-environment/\r\n\u2502       \u2514\u2500\u2500 environments/\r\n\u2502           \u251c\u2500\u2500 production/\r\n\u2502           \u2514\u2500\u2500 staging/\r\n\u2514\u2500\u2500 applications/\r\n    \u251c\u2500\u2500 sharepoint-prod/\r\n    \u2514\u2500\u2500 sharepoint-stage/\n"})}),"\n",(0,l.jsx)(n.h2,{id:"load-order--combination",children:"Load order & combination"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Load in priority order: APPLICATION \u2192 DOMAIN_ENVIRONMENT \u2192 CROSS_ENVIRONMENT \u2192 DOMAIN_SHARED \u2192 GLOBAL"}),"\n",(0,l.jsx)(n.li,{children:"Rules are additive; more specific overrides general when conflicts arise"}),"\n",(0,l.jsx)(n.li,{children:"Deny-override is preserved at evaluation time"}),"\n"]}),"\n",(0,l.jsx)(n.mermaid,{value:"sequenceDiagram\r\n  participant PDP\r\n  participant Registry as App Registry\r\n  participant Loader as Policy Loader\r\n\r\n  PDP->>Registry: Resolve(app_id)\r\n  Registry--\x3e>PDP: Domain/env (internal)\r\n  PDP->>Loader: Load policies for app_id\r\n  Loader--\x3e>PDP: 1) Application\r\n  Loader--\x3e>PDP: 2) Domain+Environment\r\n  Loader--\x3e>PDP: 3) Cross-Environment\r\n  Loader--\x3e>PDP: 4) Domain Shared\r\n  Loader--\x3e>PDP: 5) Global fallback"}),"\n",(0,l.jsx)(n.h2,{id:"conflict-resolution-examples",children:"Conflict resolution examples"}),"\n",(0,l.jsx)(n.h3,{id:"example-1-application-overrides-domain-shared",children:"Example 1: Application overrides domain shared"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# domains/sharepoint/shared/document-actions.yaml\r\nrules:\r\n  - resource: document\r\n    action: delete\r\n    effect: permit\r\n\r\n# applications/sharepoint-prod/site-permissions.yaml\r\nrules:\r\n  - resource: document\r\n    action: delete\r\n    effect: deny\r\n    description: No deletion in production\n"})}),"\n",(0,l.jsx)(n.p,{children:"Result: Most-specific (application) rule wins; delete is denied."}),"\n",(0,l.jsx)(n.h3,{id:"example-2-deny-override-across-levels",children:"Example 2: Deny-override across levels"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# global/authentication.yaml\r\nrules:\r\n  - resource: "*"\r\n    action: "*"\r\n    denyIf: subject.status == \'suspended\'\r\n\r\n# application rule (permit)\r\nrules:\r\n  - resource: document\r\n    action: read\r\n    effect: permit\n'})}),"\n",(0,l.jsx)(n.p,{children:"Result: Global deny matches \u2192 final decision DENY."}),"\n",(0,l.jsx)(n.h2,{id:"author-guidance",children:"Author guidance"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Put broad safety nets in Global/Domain Shared; narrow allowances in Application."}),"\n",(0,l.jsx)(n.li,{children:"Prefer explicit application overrides to implicit precedence."}),"\n",(0,l.jsx)(n.li,{children:"Use traces (debug_tracing.md) to verify which level provided each rule."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Missing or invalid ",(0,l.jsx)(n.code,{children:"pdp_application"})," falls back to GLOBAL path."]}),"\n",(0,l.jsxs)(n.li,{children:["Caching: request-level and registry-level TTLs recommended (see ",(0,l.jsx)(n.code,{children:"performance_caching.md"}),")."]}),"\n",(0,l.jsx)(n.li,{children:"Effect normalization occurs at load time for consistency."}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>s});var r=i(96540);const l={},o=r.createContext(l);function a(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);