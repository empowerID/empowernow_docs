"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[4798],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var r=i(96540);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}},77303:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"services/bff/explanation/bff-design-pattern","title":"Backend\u2011for\u2011Frontend (BFF) Design Pattern","description":"The problem a BFF solves","source":"@site/docs/services/bff/explanation/bff-design-pattern.md","sourceDirName":"services/bff/explanation","slug":"/services/bff/explanation/bff-design-pattern","permalink":"/empowernow_docs/docs/services/bff/explanation/bff-design-pattern","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/bff/explanation/bff-design-pattern.md","tags":[{"inline":true,"label":"service:bff","permalink":"/empowernow_docs/docs/tags/service-bff"},{"inline":true,"label":"type:explanation","permalink":"/empowernow_docs/docs/tags/type-explanation"},{"inline":true,"label":"audience:architect","permalink":"/empowernow_docs/docs/tags/audience-architect"},{"inline":true,"label":"audience:frontend","permalink":"/empowernow_docs/docs/tags/audience-frontend"},{"inline":true,"label":"audience:backend","permalink":"/empowernow_docs/docs/tags/audience-backend"}],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Backend\u2011for\u2011Frontend (BFF) Design Pattern","sidebar_position":3,"tags":["service:bff","type:explanation","audience:architect","audience:frontend","audience:backend"]},"sidebar":"tutorialSidebar","previous":{"title":"Authorization Model (PDP, Mapping, Caching)","permalink":"/empowernow_docs/docs/services/bff/explanation/authorization"},"next":{"title":"Architecture","permalink":"/empowernow_docs/docs/services/bff/explanation/architecture"}}');var s=i(74848),t=i(28453);const a={title:"Backend\u2011for\u2011Frontend (BFF) Design Pattern",sidebar_position:3,tags:["service:bff","type:explanation","audience:architect","audience:frontend","audience:backend"]},o=void 0,l={},c=[{value:"The problem a BFF solves",id:"the-problem-a-bff-solves",level:2},{value:"Our approach",id:"our-approach",level:2},{value:"How it works (at a glance)",id:"how-it-works-at-a-glance",level:2},{value:"Minimal composition example (custom endpoint)",id:"minimal-composition-example-custom-endpoint",level:2},{value:"Configuring a BFF",id:"configuring-a-bff",level:2},{value:"When to use this pattern",id:"when-to-use-this-pattern",level:2},{value:"See also",id:"see-also",level:2}];function d(e){const n={code:"code",h2:"h2",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"the-problem-a-bff-solves",children:"The problem a BFF solves"}),"\n",(0,s.jsx)(n.p,{children:"Modern UIs (web SPAs, mobile, desktop) often need to call multiple services with different data shapes, error models, and auth semantics. Typical pain points:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Chattiness and over/under\u2011fetching: multiple round\u2011trips and large, general\u2011purpose payloads per screen"}),"\n",(0,s.jsx)(n.li,{children:"Inconsistent security: tokens in the browser, per\u2011service CORS, varying authZ policies"}),"\n",(0,s.jsx)(n.li,{children:"Coupling and coordination overhead: backend teams become a bottleneck shaping responses for multiple UI clients"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"our-approach",children:"Our approach"}),"\n",(0,s.jsx)(n.p,{children:"EmpowerNow\u2019s BFF is an application\u2011aware gateway that sits between UIs and services. It provides a secure session boundary, centralized authorization (PDP), pragmatic routing, and optional composition when needed."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Secure session boundary: OAuth/OIDC terminates server\u2011side; the browser only holds an HttpOnly session cookie (+ CSRF)"}),"\n",(0,s.jsxs)(n.li,{children:["Central authorization: per\u2011request PDP decisions mapped from path/method/body via ",(0,s.jsx)(n.code,{children:"pdp.yaml"})]}),"\n",(0,s.jsxs)(n.li,{children:["Pragmatic routing: canonical ",(0,s.jsx)(n.code,{children:"/api/<app>/**"})," front door defined in ",(0,s.jsx)(n.code,{children:"routes.yaml"})]}),"\n",(0,s.jsx)(n.li,{children:"Composition when needed: add custom BFF endpoints to aggregate, reshape, or validate data across services"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"What this is not: a replacement for global edge concerns (WAF/DDOS, productization/monetization) or a mandate to move all domain logic into the BFF."}),"\n",(0,s.jsx)(n.h2,{id:"how-it-works-at-a-glance",children:"How it works (at a glance)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["SPA calls same\u2011origin ",(0,s.jsx)(n.code,{children:"/api/**"})]}),"\n",(0,s.jsxs)(n.li,{children:["Edge (Traefik) optionally invokes ",(0,s.jsx)(n.code,{children:"/auth/verify"})," (ForwardAuth)"]}),"\n",(0,s.jsx)(n.li,{children:"BFF authenticates the session, evaluates PDP (if configured), then proxies to upstream with per\u2011service tokens"}),"\n",(0,s.jsx)(n.li,{children:"For custom endpoints, the BFF can call multiple upstreams and shape a single response"}),"\n"]}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\r\n  autonumber\r\n  participant SPA as SPA\r\n  participant Edge as Traefik\r\n  participant BFF as BFF\r\n  participant PDP as PDP\r\n  participant S1 as Service A\r\n  participant S2 as Service B\r\n  SPA->>Edge: GET /api/frontpage\r\n  Edge->>BFF: ForwardAuth /auth/verify (cookie)\r\n  BFF--\x3e>Edge: 200 if session valid\r\n  Edge--\x3e>SPA: continue\r\n  SPA->>BFF: GET /api/frontpage\r\n  BFF->>PDP: evaluate(resource, action, id?)\r\n  PDP--\x3e>BFF: allow\r\n  par fetch A\r\n    BFF->>S1: GET /user/{id}\r\n    S1--\x3e>BFF: 200 JSON\r\n  and fetch B\r\n    BFF->>S2: GET /catalog\r\n    S2--\x3e>BFF: 200 JSON\r\n  end\r\n  BFF--\x3e>SPA: 200 { user: {...}, featured: {...} }"}),"\n",(0,s.jsx)(n.h2,{id:"minimal-composition-example-custom-endpoint",children:"Minimal composition example (custom endpoint)"}),"\n",(0,s.jsx)(n.p,{children:"When you need to aggregate data from multiple services into one response, create a small BFF handler. Example shape only (your codebase contains the building blocks; see links below):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# app/endpoints/frontpage.py\r\nfrom typing import Dict, Any\r\nfrom fastapi import APIRouter, Depends\r\n\r\nrouter = APIRouter()\r\n\r\n@router.get("/api/frontpage")\r\ndef get_frontpage(current_session = Depends(require_session)) -> Dict[str, Any]:\r\n    user = users_client.get_user(current_session.user_id)\r\n    catalog = catalog_client.get_featured()\r\n    return {\r\n        "user": {\r\n            "id": user.id,\r\n            "name": user.name,\r\n            "email": user.email,\r\n        },\r\n        "featured": catalog.featured,\r\n    }\n'})}),"\n",(0,s.jsx)(n.p,{children:"Route and authorization are still governed by the same configuration surfaces:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"routes.yaml"}),": define ",(0,s.jsx)(n.code,{children:"/api/frontpage"})," with ",(0,s.jsx)(n.code,{children:"auth: session"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"pdp.yaml"}),": map ",(0,s.jsx)(n.code,{children:"/api/frontpage"})," (GET) to your resource/action so PDP is evaluated consistently"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuring-a-bff",children:"Configuring a BFF"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Routing and security: see ",(0,s.jsx)(n.code,{children:"Reference \u2192 YAML proxy (routes.yaml)"})]}),"\n",(0,s.jsxs)(n.li,{children:["PDP mapping: see ",(0,s.jsx)(n.code,{children:"Reference \u2192 PDP mapping"})]}),"\n",(0,s.jsxs)(n.li,{children:["SPA wiring and DX: see ",(0,s.jsx)(n.code,{children:"Tutorials \u2192 React SPA + BFF \u2014 Golden Path"})]}),"\n",(0,s.jsxs)(n.li,{children:["Admin setup (login \u2192 callback \u2192 verify): see ",(0,s.jsx)(n.code,{children:"Tutorials \u2192 Admin Quickstart"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"when-to-use-this-pattern",children:"When to use this pattern"}),"\n",(0,s.jsx)(n.p,{children:"Use a BFF when you want:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"One secure front door for a UI: session cookie + CSRF, no tokens in the browser"}),"\n",(0,s.jsx)(n.li,{children:"Centralized, per\u2011endpoint authorization and audit"}),"\n",(0,s.jsxs)(n.li,{children:["Stable client paths (",(0,s.jsx)(n.code,{children:"/api/<app>/**"}),") decoupled from service internals"]}),"\n",(0,s.jsx)(n.li,{children:"Occasional composition/reshaping without pushing that burden to every service"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Prefer direct, single\u2011service proxy routes (no custom code) when:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The UI can consume a single upstream as\u2011is with stable latency and payloads"}),"\n",(0,s.jsx)(n.li,{children:"You don\u2019t need cross\u2011service composition for the user journey"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Not a fit:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Pure machine\u2011to\u2011machine traffic without a browser"}),"\n",(0,s.jsx)(n.li,{children:"Global edge responsibilities (WAF, bot protection, API monetization) \u2014 keep them at the edge"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Explanations:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"BFF for SPAs \u2014 How It Works"}),"\n",(0,s.jsx)(n.li,{children:"BFF Gateway Architecture (scenarios & comparison)"}),"\n",(0,s.jsx)(n.li,{children:"Executive Overview"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Reference:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"YAML proxy (routes.yaml)"}),"\n",(0,s.jsx)(n.li,{children:"PDP mapping (pdp.yaml)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Tutorials:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Admin Quickstart"}),"\n",(0,s.jsx)(n.li,{children:"React SPA + BFF \u2014 Golden Path"}),"\n"]}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);