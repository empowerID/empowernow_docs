"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[8637],{28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>l});var s=i(96540);const r={},d=s.createContext(r);function c(e){const n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(d.Provider,{value:n},e.children)}},47552:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"source_content/membership_service_schema_and_endpoints","title":"Membership Service \u2014 Graph Schema, PIP Surface, and Gap Analysis","description":"What this is: The authoritative relationship layer for EmpowerNow\u2019s Identity Fabric. It stores who can act for whom (and under what boundaries) and exposes a policy\u2011information point (PIP) surface the PDP uses to compute constraints.","source":"@site/docs/source_content/membership_service_schema_and_endpoints.md","sourceDirName":"source_content","slug":"/source_content/membership_service_schema_and_endpoints","permalink":"/empowernow_docs/docs/source_content/membership_service_schema_and_endpoints","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/source_content/membership_service_schema_and_endpoints.md","tags":[],"version":"current","frontMatter":{}}');var r=i(74848),d=i(28453);const c={},l="Membership Service \u2014 Graph Schema, PIP Surface, and Gap Analysis",o={},t=[{value:"0) Where Membership fits (system overview)",id:"0-where-membership-fits-system-overview",level:2},{value:"1) Graph model (labels, properties, and edges)",id:"1-graph-model-labels-properties-and-edges",level:2},{value:"1.1 Node labels (current)",id:"11-node-labels-current",level:3},{value:"1.2 Relationship types (current)",id:"12-relationship-types-current",level:3},{value:"1.3 Visual schema (high level)",id:"13-visual-schema-high-level",level:3},{value:"1.4 Constraints &amp; indexes (Neo4j DDL)",id:"14-constraints--indexes-neo4j-ddl",level:3},{value:"2) Business logic (what the service does)",id:"2-business-logic-what-the-service-does",level:2},{value:"3) HTTP surface (selected)",id:"3-http-surface-selected",level:2},{value:"3.1 CRUD &amp; discovery",id:"31-crud--discovery",level:3},{value:"3.2 PIP surface for PDP (stable v1)",id:"32-pip-surface-for-pdp-stable-v1",level:3},{value:"4) Fit vs. gaps (what\u2019s done, what\u2019s left)",id:"4-fit-vs-gaps-whats-done-whats-left",level:2},{value:"4.1 Strong fit (already in place)",id:"41-strong-fit-already-in-place",level:3},{value:"4.2 Known gaps (actionable)",id:"42-known-gaps-actionable",level:3},{value:"4.3 Identity\u2011chaining graph pattern (for OAuth chaining add\u2011on)",id:"43-identitychaining-graph-pattern-for-oauth-chaining-addon",level:3},{value:"5) Operational notes (dev\u2011to\u2011dev)",id:"5-operational-notes-devtodev",level:2},{value:"6) PIP reference queries (Cypher snippets)",id:"6-pip-reference-queries-cypher-snippets",level:2},{value:"7) Endpoint catalogue (concise)",id:"7-endpoint-catalogue-concise",level:2},{value:"8) Gap remediation plan (small PRs; high impact)",id:"8-gap-remediation-plan-small-prs-high-impact",level:2},{value:"9) Appendix\u2014Health &amp; diagnostics (handy endpoints)",id:"9-appendixhealth--diagnostics-handy-endpoints",level:2},{value:"One\u2011page takeaway",id:"onepage-takeaway",level:3}];function a(e){const n={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"membership-service--graph-schema-pip-surface-and-gap-analysis",children:"Membership Service \u2014 Graph Schema, PIP Surface, and Gap Analysis"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What this is:"})," The ",(0,r.jsx)(n.strong,{children:"authoritative relationship layer"})," for EmpowerNow\u2019s Identity Fabric. It stores who can act for whom (and under what boundaries) and exposes a ",(0,r.jsx)(n.strong,{children:"policy\u2011information point (PIP)"})," surface the PDP uses to compute constraints.\n",(0,r.jsx)(n.strong,{children:"What it is not:"})," Not a policy engine, not a tool catalog, not a token service. Policy remains in PDP/AuthZEN; tool metadata lives in the ",(0,r.jsx)(n.strong,{children:"Tool Registry"}),"; tokens are minted by the ",(0,r.jsx)(n.strong,{children:"IdP"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This edition tightens the overview, adds ",(0,r.jsx)(n.strong,{children:"Mermaid"})," visuals, and aligns terminology with the ARIA v1 architecture you finalized. It preserves your existing endpoints while clarifying responsibilities and closing gaps called out in prior reviews."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"0-where-membership-fits-system-overview",children:"0) Where Membership fits (system overview)"}),"\n",(0,r.jsx)(n.mermaid,{value:'graph TB\n  subgraph "Control Plane"\n    IDP["IdP<br/>OAuth TE, RAR, DPoP"]\n    PDP["PDP (AuthZEN)"]\n    MS["Membership<br/>Neo4j"]\n    TR["Tool Registry"]\n    RV["Receipt Vault"]\n  end\n\n  subgraph "Data Plane"\n    ARIA["ARIA Gateway (MCP PEP)"]\n    BFF["LLM BFF"]\n    Tools["MCP Tools / HTTP APIs"]\n  end\n\n  IDP --\x3e|lookup delegation/budget| MS\n  IDP --\x3e|schema pins| TR\n  ARIA --\x3e|/access/v1/evaluation| PDP\n  PDP --\x3e|PIP lookups| MS\n  ARIA --\x3e|tool metadata| TR\n  ARIA --\x3e|receipts| RV\n  BFF --\x3e|/access/v1/evaluation| PDP\n\n  ARIA --\x3e|enforce constraints| Tools\n  BFF --\x3e|call models| Tools'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why this separation exists:"})," Membership is the ",(0,r.jsx)(n.strong,{children:"graph of relationships"})," (delegations, groupings, ownership, location, etc.). PDP merges Membership facts with authored policy and request context to return ",(0,r.jsx)(n.strong,{children:"constraints + obligations"}),". This mirrors the ",(0,r.jsx)(n.strong,{children:"ABAC\u2013ReBAC split"})," and ",(0,r.jsx)(n.strong,{children:"unified identity model"})," described in your June white paper (see the \u201cABAC\u2011ReBAC Hybrid Architecture\u201d and \u201cUnified Identity Model\u201d sections and diagram), which our v1 implements directly.\xa0"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-graph-model-labels-properties-and-edges",children:"1) Graph model (labels, properties, and edges)"}),"\n",(0,r.jsx)(n.h3,{id:"11-node-labels-current",children:"1.1 Node labels (current)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Identity"})," ",(0,r.jsx)(n.em,{children:"(abstract)"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Concrete subtypes: ",(0,r.jsx)(n.strong,{children:"Person"}),", ",(0,r.jsx)(n.strong,{children:"Account"}),", ",(0,r.jsx)(n.strong,{children:"AIAgent"}),", ",(0,r.jsx)(n.strong,{children:"Service"}),", ",(0,r.jsx)(n.strong,{children:"MCPService"})," (",(0,r.jsx)(n.code,{children:"Identity:Service:MCPService"}),")"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Group"}),", ",(0,r.jsx)(n.strong,{children:"ManagementRole"}),", ",(0,r.jsx)(n.strong,{children:"BusinessRole"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"BusinessRoleLocation (BRL)"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Location"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Resource"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"RTR"})," ",(0,r.jsx)(n.em,{children:"(entitlements/permissions bundle)"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Tool"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Policy"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"MCPResource"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"MCPPrompt"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"MCPPolicyBinding"})," (reference data for PDP; not enforced locally)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Proposed v1.1 additions"})," (for identity chaining & data scope):\n",(0,r.jsx)(n.strong,{children:"Tenant"}),", ",(0,r.jsx)(n.strong,{children:"SaaSApp"})," \u2014 used to compute data scopes and chain\u2011eligibility (see \xa74.3)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key properties (suggested minimums)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Identity"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"kind"})," (person|service|agent|account), ",(0,r.jsx)(n.code,{children:"display_name"}),", ",(0,r.jsx)(n.code,{children:"state"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AIAgent"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"owner_id"})," ",(0,r.jsx)(n.em,{children:"(ref)"}),", ",(0,r.jsx)(n.code,{children:"trust_score?"}),", ",(0,r.jsx)(n.code,{children:"version?"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Service|MCPService"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"service_type"}),", ",(0,r.jsx)(n.code,{children:"display_name"}),", ",(0,r.jsx)(n.code,{children:"supported_protocols[]"}),", ",(0,r.jsx)(n.code,{children:"preferred_protocol?"}),", ",(0,r.jsx)(n.code,{children:"websocket_url?"}),", ",(0,r.jsx)(n.code,{children:"sse_url?"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Tool"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"name"}),", ",(0,r.jsx)(n.code,{children:"version"}),", ",(0,r.jsx)(n.code,{children:"service_id"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Resource"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"type"}),", ",(0,r.jsx)(n.code,{children:"owner_id?"}),", ",(0,r.jsx)(n.code,{children:"sensitivity?"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MCPResource"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"name"}),", ",(0,r.jsx)(n.code,{children:"uri"}),", ",(0,r.jsx)(n.code,{children:"mime_type"}),", ",(0,r.jsx)(n.code,{children:"size?"}),", ",(0,r.jsx)(n.code,{children:"etag?"}),", ",(0,r.jsx)(n.code,{children:"last_modified?"}),", ",(0,r.jsx)(n.code,{children:"annotations{}"}),", ",(0,r.jsx)(n.code,{children:"schema_hash?"}),", ",(0,r.jsx)(n.code,{children:"last_discovered_at?"}),", ",(0,r.jsx)(n.code,{children:"discovered_by?"}),", ",(0,r.jsx)(n.code,{children:"origin_hash?"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MCPPrompt"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"name"}),", ",(0,r.jsx)(n.code,{children:"description?"}),", ",(0,r.jsx)(n.code,{children:"version"}),", ",(0,r.jsx)(n.code,{children:"arguments[]"}),", ",(0,r.jsx)(n.code,{children:"content"}),", ",(0,r.jsx)(n.code,{children:"schema_hash?"}),", ",(0,r.jsx)(n.code,{children:"last_discovered_at?"}),", ",(0,r.jsx)(n.code,{children:"discovered_by?"}),", ",(0,r.jsx)(n.code,{children:"origin_hash?"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Policy"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"rev"}),", ",(0,r.jsx)(n.code,{children:"uri"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Tenant"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"name"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SaaSApp"}),": ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"audience"}),", ",(0,r.jsx)(n.code,{children:"scopes[]"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"12-relationship-types-current",children:"1.2 Relationship types (current)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:Person|:Identity:Person) -[:BELONGS_TO]-> (:Account)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:Identity|:BRL|:Account) -[:MEMBER_OF {assignment_type,id,ts...}]-> (:Group|:ManagementRole|:BRL)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:Identity:Person) -[:DELEGATES_TO {id,status,capabilities[],constraints?,...}]-> (:Identity:AIAgent)"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"(:Resource) -[:GRANTS_ACCESS]-> (:RTR)"})," ",(0,r.jsx)(n.em,{children:"(read by queries)"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"(:Identity|:Role) -[:HAS_RTR]-> (:RTR)"})," and scoped ",(0,r.jsx)(n.code,{children:"-[:HAS_RTR_AT]-> (:Location)"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:Resource) -[:LOCATED_IN]-> (:Location)"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"(any) -[:POLICY_REF {rev?}]-> (:Policy)"})," ",(0,r.jsx)(n.em,{children:"(normalized)"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:Identity:Service) -[:PROVIDES]-> (:Tool)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:AIAgent) -[:HAS_CAPABILITY]-> (:Tool)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:MCPService) -[:PROVIDES_RESOURCE {version?, discovered_at?, discovered_by?, origin_hash?}]-> (:MCPResource)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"(:MCPService) -[:OFFERS_PROMPT {version?, discovered_at?, discovered_by?, origin_hash?}]-> (:MCPPrompt)"})}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Recommended additions"}),"\n",(0,r.jsx)(n.code,{children:"(:AIAgent) -[:CONTROLLED_BY]-> (:Person|:Service)"}),"\n",(0,r.jsx)(n.code,{children:"(:Identity|:Group) -[:OWNS_RESOURCE {role: 'primary'|'deputy'}]-> (:Resource)"}),"\n",(0,r.jsx)(n.code,{children:"(:MCPService) -[:USES_TENANT]-> (:Tenant)"}),"\n",(0,r.jsx)(n.code,{children:"(:Tool) -[:REQUIRES]-> (:SaaSApp {scopes: [...]})"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"13-visual-schema-high-level",children:"1.3 Visual schema (high level)"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n  Person((Person)) -- BELONGS_TO --\x3e Account[(Account)]\n  Person -- DELEGATES_TO --\x3e Agent((AIAgent))\n  Agent -- HAS_CAPABILITY --\x3e Tool[[Tool]]\n  Service((Service)) -- PROVIDES --\x3e Tool\n  Resource[[Resource]] -- GRANTS_ACCESS --\x3e RTR[(RTR)]\n  Resource -- LOCATED_IN --\x3e Location((Location))\n  Identity((Identity)) -- MEMBER_OF --\x3e Group[(Group)]\n  any((any)) -- POLICY_REF --\x3e Policy[(Policy)]\n\n  %% Recommended edges\n  Agent -. CONTROLLED_BY .-> Person\n  Identity -. OWNS_RESOURCE .-> Resource\n  Tool -. REQUIRES .-> SaaSApp[(SaaSApp)]\n  MCPService((MCPService)) -. USES_TENANT .-> Tenant[(Tenant)]"}),"\n",(0,r.jsx)(n.h3,{id:"14-constraints--indexes-neo4j-ddl",children:"1.4 Constraints & indexes (Neo4j DDL)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cypher",children:"CREATE CONSTRAINT unique_identity_id IF NOT EXISTS\nFOR (n:Identity) REQUIRE n.id IS UNIQUE;\n\nCREATE CONSTRAINT unique_delegation_id IF NOT EXISTS\nFOR ()-[d:DELEGATES_TO]-() REQUIRE d.id IS UNIQUE;\n\nCREATE CONSTRAINT tool_id_unique IF NOT EXISTS\nFOR (t:Tool) REQUIRE t.id IS UNIQUE;\n\nCREATE INDEX tool_service_idx IF NOT EXISTS\nFOR (t:Tool) ON (t.service_id, t.version, t.name);\n\nCREATE CONSTRAINT mcp_service_id_unique IF NOT EXISTS\nFOR (s:MCPService) REQUIRE s.id IS UNIQUE;\n\n// MCP Resources\nCREATE CONSTRAINT mcp_resource_id_unique IF NOT EXISTS\nFOR (r:MCPResource) REQUIRE r.id IS UNIQUE;\nCREATE INDEX mcp_resource_name_idx IF NOT EXISTS\nFOR (r:MCPResource) ON (r.name);\nCREATE INDEX mcp_resource_uri_idx IF NOT EXISTS\nFOR (r:MCPResource) ON (r.uri);\nCREATE INDEX mcp_resource_mime_idx IF NOT EXISTS\nFOR (r:MCPResource) ON (r.mime_type);\n\n// MCP Prompts\nCREATE CONSTRAINT mcp_prompt_id_unique IF NOT EXISTS\nFOR (p:MCPPrompt) REQUIRE p.id IS UNIQUE;\nCREATE INDEX mcp_prompt_name_idx IF NOT EXISTS\nFOR (p:MCPPrompt) ON (p.name);\nCREATE INDEX mcp_prompt_version_idx IF NOT EXISTS\nFOR (p:MCPPrompt) ON (p.version);\n\n// MCP Policy Binding (reference data for PDP)\nCREATE CONSTRAINT mcp_policy_binding_id_unique IF NOT EXISTS\nFOR (b:MCPPolicyBinding) REQUIRE b.id IS UNIQUE;\n\nCREATE CONSTRAINT tenant_id_unique IF NOT EXISTS\nFOR (t:Tenant) REQUIRE t.id IS UNIQUE;\n\nCREATE CONSTRAINT saasapp_id_unique IF NOT EXISTS\nFOR (a:SaaSApp) REQUIRE a.id IS UNIQUE;\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-business-logic-what-the-service-does",children:"2) Business logic (what the service does)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Assignments:"})," single/bulk create, update, delete with source/target validation."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Delegations:"})," create/update DELEGATES_TO edges with ",(0,r.jsx)(n.code,{children:"status"}),", ",(0,r.jsx)(n.code,{children:"capabilities[]"}),", and optional constraint pointers."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Policy pointers:"})," attach/detach ",(0,r.jsx)(n.code,{children:"POLICY_REF"})," with safe ",(0,r.jsx)(n.code,{children:"rev"})," handling."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RBAC utilities:"})," read ",(0,r.jsx)(n.code,{children:"HAS_RTR"}),", ",(0,r.jsx)(n.code,{children:"HAS_RTR_AT"})," and ",(0,r.jsx)(n.code,{children:"GRANTS_ACCESS"})," via Resource/Location scopes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Search & reports:"})," full\u2011text identity search, counts, orphan detection, path probes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Agent & MCP catalog:"})," register MCP services + tools; list capabilities by agent/service."]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["This implements the ",(0,r.jsx)(n.strong,{children:"graph\u2011native relationship layer"})," your white paper calls for, keeping policy logic outside the database for speed and auditability.\xa0"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-http-surface-selected",children:"3) HTTP surface (selected)"}),"\n",(0,r.jsx)(n.h3,{id:"31-crud--discovery",children:"3.1 CRUD & discovery"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Identities"}),"\n",(0,r.jsx)(n.code,{children:"POST /api/v1/identities"}),", ",(0,r.jsx)(n.code,{children:"POST /api/v1/persons"}),", ",(0,r.jsx)(n.code,{children:"POST /api/v1/ai-agents"}),"\n",(0,r.jsx)(n.code,{children:"GET /api/v1/identities"}),", ",(0,r.jsx)(n.code,{children:"GET /api/v1/identities/{id}"}),", ",(0,r.jsx)(n.code,{children:"DELETE /api/v1/identities/{id}"}),"\n",(0,r.jsx)(n.code,{children:"GET /api/v1/identities/fulltext-search?q=..."})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Locations"}),"\n",(0,r.jsx)(n.code,{children:"GET /api/v1/locations"}),", ",(0,r.jsx)(n.code,{children:"GET /api/v1/locations/{id}"}),"\n",(0,r.jsx)(n.code,{children:"POST /api/v1/locations"}),"\n",(0,r.jsx)(n.code,{children:"POST /api/v1/locations/orphaned/fix"}),", ",(0,r.jsx)(n.code,{children:"GET /api/v1/locations/orphaned"}),"\n",(0,r.jsx)(n.code,{children:"DELETE /api/v1/locations/{id}"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Roles & Membership"}),"\n",(0,r.jsx)(n.code,{children:"POST /api/v1/assignments"}),", ",(0,r.jsx)(n.code,{children:"PUT /api/v1/assignments"}),", ",(0,r.jsx)(n.code,{children:"POST /api/v1/assignments/bulk"}),"\n",(0,r.jsx)(n.code,{children:"DELETE /api/v1/management_roles/{id}"}),"\nRole listings (direct/all)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"BRL & Groups"}),"\n",(0,r.jsx)(n.code,{children:"POST /api/v1/brl"}),", ",(0,r.jsx)(n.code,{children:"PUT /api/v1/brl/{id}"}),", ",(0,r.jsx)(n.code,{children:"DELETE /api/v1/brl/{id}"}),"\n",(0,r.jsx)(n.code,{children:"GET /api/v1/groups/top-by-membership"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Policies"}),"\n",(0,r.jsx)(n.code,{children:"GET /api/v1/policies"}),", ",(0,r.jsx)(n.code,{children:"GET /api/v1/policies/{id}"}),"\n",(0,r.jsx)(n.code,{children:"POST /api/v1/policies"}),", ",(0,r.jsx)(n.code,{children:"DELETE /api/v1/policies/{id}"}),"\n",(0,r.jsx)(n.code,{children:"POST /api/v1/assign/policy"}),", ",(0,r.jsx)(n.code,{children:"DELETE /api/v1/assign/policy"}),"\n",(0,r.jsx)(n.code,{children:"DELETE /api/v1/policies/{id}/with-relationships"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Reports"}),"\n",(0,r.jsx)(n.code,{children:"GET /api/v1/reports/top-identities-by-accounts?limit=15"}),"\n",(0,r.jsx)(n.code,{children:"GET /api/v1/reports/access-outliers?limit=25"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Agent & MCP"}),"\nAgent: list/create service principals, delegations, trust score, capabilities\nMCP (base: ",(0,r.jsx)(n.code,{children:"/api/v1/mcp"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /services"})," \u2192 register MCP service (supports transport fields: ",(0,r.jsx)(n.code,{children:"supported_protocols[]"}),", ",(0,r.jsx)(n.code,{children:"preferred_protocol"}),", ",(0,r.jsx)(n.code,{children:"websocket_url"}),", ",(0,r.jsx)(n.code,{children:"sse_url"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /services/{service_id}"})," / ",(0,r.jsx)(n.code,{children:"GET /services/by-name/{name}"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /services"})," (filters: ",(0,r.jsx)(n.code,{children:"service_type"}),", ",(0,r.jsx)(n.code,{children:"provider"}),", ",(0,r.jsx)(n.code,{children:"is_backend"}),", ",(0,r.jsx)(n.code,{children:"search"}),", pagination)"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"DELETE /services/{service_id}"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /services/{service_id}/tools"})," \u2192 register tool (discovery fields: ",(0,r.jsx)(n.code,{children:"schema_hash"}),", ",(0,r.jsx)(n.code,{children:"last_discovered_at"}),", ",(0,r.jsx)(n.code,{children:"discovered_by"}),", ",(0,r.jsx)(n.code,{children:"origin_hash"}),")"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"GET /services/{service_id}/tools"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /tools/{tool_id}"})," / ",(0,r.jsx)(n.code,{children:"GET /tools/by-name/{tool_name}"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"DELETE /tools/{tool_id}"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /services/{service_id}/resources"})," \u2192 register MCPResource (stores node plus ",(0,r.jsx)(n.code,{children:"PROVIDES_RESOURCE"})," rel with discovery metadata)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /services/{service_id}/prompts"})," \u2192 register MCPPrompt (stores node plus ",(0,r.jsx)(n.code,{children:"OFFERS_PROMPT"})," rel with discovery metadata)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Admin / Utilities"}),"\nHealth check, label/rel counts, shortest paths, related nodes, cleanup"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"32-pip-surface-for-pdp-stable-v1",children:"3.2 PIP surface for PDP (stable v1)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"GET /api/v1/pip/membership/capabilities?user_id=&agent_id="}),"\n\u2192 ",(0,r.jsx)(n.code,{children:'{"capabilities": ["mcp:flights:search","mcp:flights:book"]}'})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"GET /api/v1/pip/membership/delegations?user_id=&agent_id=&status=active"}),"\n\u2192 ",(0,r.jsx)(n.code,{children:'[{"delegation_id":"...","status":"active","max_steps":20,"budget_usd":100.0,"expires_at":"..."}]'})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"GET /api/v1/pip/membership/data-scope?subject_id=&resource_type="}),"\n\u2192 ",(0,r.jsx)(n.code,{children:'{"tenant_ids":["acme"],"row_filter_sql":"tenant_id IN (\'acme\')","column_mask":{}}'})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"GET /api/v1/pip/membership/step-up?subject_id="}),"\n\u2192 ",(0,r.jsx)(n.code,{children:'{"mfa_required":false,"level":"strong"}'})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"GET /api/v1/pip/membership/chain-eligibility?user_id=&agent_id=&tool_id="}),"\n\u2192 ",(0,r.jsx)(n.code,{children:'[{"audience":"okta:app:crm","scopes":["contacts.read","contacts.write"]}]'})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Call flow (PDP \u2194 Membership):"})}),"\n",(0,r.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant PDP\n  participant MS as Membership (PIP)\n  PDP->>MS: GET /pip/membership/capabilities?user_id&agent_id\n  MS--\x3e>PDP: capabilities[]\n  PDP->>MS: GET /pip/membership/data-scope?subject_id&resource_type\n  MS--\x3e>PDP: tenant_ids[], row_filter_sql\n  PDP->>MS: GET /pip/membership/step-up?subject_id\n  MS--\x3e>PDP: {mfa_required, level}\n  PDP->>MS: GET /pip/membership/chain-eligibility?user_id&agent_id&tool_id\n  MS--\x3e>PDP: [{audience, scopes[]}]\n  PDP--\x3e>PDP: Merge with policy \u2192 constraints + obligations"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-fit-vs-gaps-whats-done-whats-left",children:"4) Fit vs. gaps (what\u2019s done, what\u2019s left)"}),"\n",(0,r.jsx)(n.h3,{id:"41-strong-fit-already-in-place",children:"4.1 Strong fit (already in place)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Identity unification:"})," ",(0,r.jsx)(n.code,{children:"Account"})," promoted to ",(0,r.jsx)(n.code,{children:"Identity"}),"; consistent use in assignments and queries."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Delegations:"})," ",(0,r.jsx)(n.code,{children:"DELEGATES_TO"})," with ",(0,r.jsx)(n.code,{children:"id/status/capabilities/constraints"})," and PIP endpoints exist."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RBAC patterns:"})," ",(0,r.jsx)(n.code,{children:"HAS_RTR"})," / ",(0,r.jsx)(n.code,{children:"GRANTS_ACCESS"})," with ",(0,r.jsx)(n.code,{children:"Location"})," scoping appear in operational queries."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Agent capabilities:"})," ",(0,r.jsx)(n.code,{children:"Tool"})," nodes, ",(0,r.jsx)(n.code,{children:"PROVIDES"}),", and ",(0,r.jsx)(n.code,{children:"HAS_CAPABILITY"})," are modeled; ",(0,r.jsx)(n.code,{children:"MCPService"})," exists."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Policy pointers:"})," ",(0,r.jsx)(n.code,{children:"POLICY_REF"})," normalized; attach/detach avoids null revisions."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["These align directly with ",(0,r.jsx)(n.strong,{children:"ARIA\u2019s unified identity model"})," and the ",(0,r.jsx)(n.strong,{children:"constraints vs. obligations split"})," your white paper advocates.\xa0"]}),"\n",(0,r.jsx)(n.h3,{id:"42-known-gaps-actionable",children:"4.2 Known gaps (actionable)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"CONTROLLED_BY edge (Agent \u2192 Person/Service)"}),"\n",(0,r.jsx)(n.em,{children:"Status:"})," Partial via ownership fields; not consistently created or queried.\n",(0,r.jsx)(n.em,{children:"Action:"})," Add CRUD; enforce 1..N ownership; expose in PIP as ",(0,r.jsx)(n.code,{children:"agent_controller_ids"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Resource ownership (",(0,r.jsx)(n.code,{children:"OWNS_RESOURCE"}),")"]}),"\n",(0,r.jsx)(n.em,{children:"Status:"})," Queries only.\n",(0,r.jsx)(n.em,{children:"Action:"})," First\u2011class endpoints for assigning primary/deputy owners; surface in PIP for governance."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"RTR authoring"}),"\n",(0,r.jsx)(n.em,{children:"Status:"})," Reader\u2011heavy; minimal write APIs.\n",(0,r.jsx)(n.em,{children:"Action:"})," Add POST/DELETE for ",(0,r.jsx)(n.code,{children:"HAS_RTR"})," and ",(0,r.jsx)(n.code,{children:"HAS_RTR_AT"})," with validation hooks."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tenant / SaaSApp graph for identity chaining"}),"\n",(0,r.jsx)(n.em,{children:"Status:"})," PIP returns safe defaults.\n",(0,r.jsx)(n.em,{children:"Action:"})," Introduce ",(0,r.jsx)(n.code,{children:"Tenant"})," + ",(0,r.jsx)(n.code,{children:"SaaSApp"})," nodes and edges:\n",(0,r.jsx)(n.code,{children:"(:Tool)-[:REQUIRES]->(:SaaSApp {scopes})"})," and ",(0,r.jsx)(n.code,{children:"(:MCPService)-[:USES_TENANT]->(:Tenant)"}),";\naugment ",(0,r.jsx)(n.code,{children:"/pip/membership/data-scope"})," and ",(0,r.jsx)(n.code,{children:"/chain-eligibility"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Caching hints for PDP"}),"\n",(0,r.jsx)(n.em,{children:"Status:"})," Not standardized.\n",(0,r.jsx)(n.em,{children:"Action:"})," Add ",(0,r.jsx)(n.code,{children:"ETag"})," and ",(0,r.jsx)(n.code,{children:"Cache-Control: max-age=TTL"})," headers on PIP responses; include ",(0,r.jsx)(n.code,{children:"decision_hints.ttl_ms"})," in JSON if helpful."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"43-identitychaining-graph-pattern-for-oauth-chaining-addon",children:"4.3 Identity\u2011chaining graph pattern (for OAuth chaining add\u2011on)"}),"\n",(0,r.jsx)(n.mermaid,{value:'graph LR\n  Person((Person)) -- DELEGATES_TO --\x3e Agent((AIAgent))\n  Agent -- USES --\x3e Tool[[Tool]]\n  Tool -- REQUIRES --\x3e SaaSApp["SaaSApp<br/>audience, scopes"]\n  Agent -. ACTS_IN_TENANT .-> Tenant[(Tenant)]'}),"\n",(0,r.jsxs)(n.p,{children:["PIP computes chain\u2011eligibility by walking ",(0,r.jsx)(n.code,{children:"Agent \u2192 Tool \u2192 SaaSApp"})," and returning ",(0,r.jsx)(n.code,{children:"{audience, scopes[]}"}),"; PDP converts that into ",(0,r.jsx)(n.code,{children:"constraints.identity_chain.*"})," (used later by IdP/Gateway feature\u2011flagged chaining). This directly supports the \u201cidentity chaining\u201d backlog in ARIA v1.\xa0"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-operational-notes-devtodev",children:"5) Operational notes (dev\u2011to\u2011dev)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Fail\u2011closed defaults:"})," Missing delegation, unknown tool, or empty tenant set \u2192 deny / ",(0,r.jsx)(n.code,{children:'row_filter_sql: "1=0"'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Indices first:"})," Apply the DDL in \xa71.4 before bulk loads."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Write hygiene:"})," Prefer ",(0,r.jsx)(n.code,{children:"MERGE"})," with ",(0,r.jsx)(n.strong,{children:"idempotent"})," ",(0,r.jsx)(n.code,{children:"id"})," on edges (",(0,r.jsx)(n.code,{children:"DELEGATES_TO.id"}),"), and set ",(0,r.jsx)(n.code,{children:"status"})," with valid enum (",(0,r.jsx)(n.code,{children:"active|paused|revoked|expired"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Observability:"})," Count edges by type/label; export \u201ctop degree nodes\u201d to detect accidental fan\u2011outs."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Safety:"})," Never store raw secrets on nodes/edges; ",(0,r.jsx)(n.code,{children:"POLICY_REF.uri"})," should point to a policy store (Git/HTTP) rather than embed policy bodies."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-pip-reference-queries-cypher-snippets",children:"6) PIP reference queries (Cypher snippets)"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["These show the ",(0,r.jsx)(n.strong,{children:"intent"}),"; your production code likely wraps them."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Capabilities"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cypher",children:"MATCH (u:Identity {id:$user_id})-[:DELEGATES_TO {status:'active'}]->(:AIAgent {id:$agent_id})-[:HAS_CAPABILITY]->(t:Tool)\nRETURN collect(DISTINCT t.id) AS capabilities\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Data scope"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cypher",children:"// Tenants directly and via projects/programs (extend as needed)\nMATCH (u:Identity {id:$subject_id})-[:BELONGS_TO]->(a:Account)-[:MEMBER_OF*0..2]->(ten:Tenant)\nWITH collect(DISTINCT ten.id) AS tids\nRETURN {tenant_ids: [x IN tids WHERE x IS NOT NULL],\n        row_filter_sql: CASE WHEN size(tids)>0\n            THEN 'tenant_id IN (''' + apoc.text.join(tids, ''',''') + ''')'\n            ELSE '1=0' END,\n        column_mask: {}} AS scope\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Chain eligibility"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cypher",children:"MATCH (u:Identity {id:$user_id})-[:DELEGATES_TO {status:'active'}]->(:AIAgent {id:$agent_id})-[:HAS_CAPABILITY]->(tool:Tool {id:$tool_id})\nMATCH (tool)-[:REQUIRES]->(app:SaaSApp)\nRETURN collect({audience: app.audience, scopes: app.scopes}) AS elig\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-endpoint-catalogue-concise",children:"7) Endpoint catalogue (concise)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"General:"})," identities, locations, roles/membership, BRL, groups, policies, reports, MCP/Agent, admin utilities \u2014 ",(0,r.jsx)(n.strong,{children:"unchanged"})," routes as in your current service."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PIP:"})," capabilities, delegations, data\u2011scope, step\u2011up, chain\u2011eligibility \u2014 ",(0,r.jsx)(n.strong,{children:"stable"})," and used by PDP today."]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"These PIP calls power PDP\u2019s constraint construction and match the \u201cfast graph + flexible policy\u201d architecture outlined in the white paper (graph lookups for relationships; policy engine for constraint logic).\xa0"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"8-gap-remediation-plan-small-prs-high-impact",children:"8) Gap remediation plan (small PRs; high impact)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CONTROLLED_BY"}),": Implemented \u2014 PUT/GET/DELETE under ",(0,r.jsx)(n.code,{children:"/api/v1/agent/agents/{agent_id}/*"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"OWNERSHIP"}),": Implemented \u2014 POST/GET/DELETE under ",(0,r.jsx)(n.code,{children:"/api/v1/resources/{resource_id}/owners"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RTR authoring"}),": Implemented \u2014 POST ",(0,r.jsx)(n.code,{children:"/api/v1/rtrs/assign"}),", ",(0,r.jsx)(n.code,{children:"/api/v1/rtrs/assign-at"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Identity chaining graph"}),": Tenant/SaaSApp materialization next (PIP works with metadata today)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance hints"}),": PIP caching TTLs present; HTTP cache headers optional next."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"9-appendixhealth--diagnostics-handy-endpoints",children:"9) Appendix\u2014Health & diagnostics (handy endpoints)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"GET /api/v1/health"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /api/v1/node-label-counts"}),", ",(0,r.jsx)(n.code,{children:"/relationship-type-counts"}),", ",(0,r.jsx)(n.code,{children:"/orphan-node-counts"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"GET /api/v1/relationship-connections?start_id=&type="})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"GET /api/v1/related-nodes?id=&hops=.."})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"GET /api/v1/shortest-path?from=&to="})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"onepage-takeaway",children:"One\u2011page takeaway"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Membership"})," = ",(0,r.jsx)(n.strong,{children:"ground truth of relationships"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PDP"})," pulls from Membership to compute ",(0,r.jsx)(n.strong,{children:"constraints"})," (tokens, egress, params, data scope) and ",(0,r.jsx)(n.strong,{children:"obligations"}),", per ARIA v1."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tool Registry"})," remains separate (schema pins, endpoints)."]}),"\n",(0,r.jsxs)(n.li,{children:["Add ",(0,r.jsx)(n.strong,{children:"CONTROLLED_BY"}),", ",(0,r.jsx)(n.strong,{children:"OWNERSHIP"}),", and ",(0,r.jsx)(n.strong,{children:"Tenant/SaaSApp"})," now to unlock identity chaining and richer scopes\u2014fully consistent with your June vision and the final ARIA v1 shape.\xa0"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);