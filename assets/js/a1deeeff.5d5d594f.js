"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[4906],{28453:(e,c,r)=>{r.d(c,{R:()=>i,x:()=>n});var s=r(96540);const t={},o=s.createContext(t);function i(e){const c=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(c):{...c,...e}},[c,e])}function n(e){let c;return c=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:c},e.children)}},53169:(e,c,r)=>{r.r(c),r.d(c,{assets:()=>a,contentTitle:()=>n,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"services/bff/how-to/tune-legacy-circuit-cache","title":"Tune legacy proxy circuit breaker and cache","description":"Goal: adjust circuit breaker and caching behavior for legacy proxy.","source":"@site/docs/services/bff/how-to/tune-legacy-circuit-cache.md","sourceDirName":"services/bff/how-to","slug":"/services/bff/how-to/tune-legacy-circuit-cache","permalink":"/empowernow_docs/docs/services/bff/how-to/tune-legacy-circuit-cache","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/bff/how-to/tune-legacy-circuit-cache.md","tags":[{"inline":true,"label":"service:bff","permalink":"/empowernow_docs/docs/tags/service-bff"},{"inline":true,"label":"type:how-to","permalink":"/empowernow_docs/docs/tags/type-how-to"},{"inline":true,"label":"roles:devops","permalink":"/empowernow_docs/docs/tags/roles-devops"}],"version":"current","frontMatter":{"id":"tune-legacy-circuit-cache","title":"Tune legacy proxy circuit breaker and cache","sidebar_label":"Tune CB/cache","tags":["service:bff","type:how-to","roles:devops"]},"sidebar":"tutorialSidebar","previous":{"title":"Traefik ForwardAuth","permalink":"/empowernow_docs/docs/services/bff/how-to/traefik-forwardauth"},"next":{"title":"Update routes after restructure","permalink":"/empowernow_docs/docs/services/bff/how-to/update-routes-after-structure-change"}}');var t=r(74848),o=r(28453);const i={id:"tune-legacy-circuit-cache",title:"Tune legacy proxy circuit breaker and cache",sidebar_label:"Tune CB/cache",tags:["service:bff","type:how-to","roles:devops"]},n=void 0,a={},l=[];function d(e){const c={code:"code",li:"li",ol:"ol",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.p,{children:"Goal: adjust circuit breaker and caching behavior for legacy proxy."}),"\n",(0,t.jsxs)(c.p,{children:["Config: ",(0,t.jsx)(c.code,{children:"ServiceConfigs/BFF/config/legacy_services.yaml"})]}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"circuit_breaker.threshold"}),", ",(0,t.jsx)(c.code,{children:"circuit_breaker.reset_time"})]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"response_cache.enabled"}),", ",(0,t.jsx)(c.code,{children:"default_ttl"}),", ",(0,t.jsx)(c.code,{children:"max_size"})]}),"\n",(0,t.jsx)(c.li,{children:(0,t.jsx)(c.code,{children:"legacy_service_timeouts.{service}"})}),"\n"]}),"\n",(0,t.jsx)(c.p,{children:"Procedure"}),"\n",(0,t.jsxs)(c.ol,{children:["\n",(0,t.jsx)(c.li,{children:"Update the YAML values above and promote per SOP"}),"\n",(0,t.jsxs)(c.li,{children:["Validate with traffic; monitor Prometheus:","\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsx)(c.li,{children:(0,t.jsx)(c.code,{children:'circuit_breaker_status{service="..."}'})}),"\n",(0,t.jsx)(c.li,{children:(0,t.jsx)(c.code,{children:'circuit_breaks_total{service="..."}'})}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"cache_hits_total"}),", ",(0,t.jsx)(c.code,{children:"cache_misses_total"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(c.p,{children:"Notes"}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsx)(c.li,{children:"Non\u2011GET writes invalidate cache for affected paths automatically"}),"\n",(0,t.jsxs)(c.li,{children:["413 indicates request body exceeds ",(0,t.jsx)(c.code,{children:"request_limits.max_body_size"})]}),"\n"]}),"\n",(0,t.jsxs)(c.p,{children:["See also: ",(0,t.jsx)(c.code,{children:"../reference/legacy-proxy"}),", ",(0,t.jsx)(c.code,{children:"./alerting-cookbook"})]})]})}function u(e={}){const{wrapper:c}={...(0,o.R)(),...e.components};return c?(0,t.jsx)(c,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);