"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[293],{28453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>t});var s=r(96540);const i={},c=s.createContext(i);function d(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(c.Provider,{value:n},e.children)}},62063:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"services/crud-service/reference/connectors/azure-connector-guide","title":"Azure (Microsoft Graph) connector \u2013 capabilities and configuration","description":"Production\u2011grade Graph client in CRUD Service with retries, pagination, observability, flexible config, and standardized responses.","source":"@site/docs/services/crud-service/reference/connectors/azure-connector-guide.md","sourceDirName":"services/crud-service/reference/connectors","slug":"/services/crud-service/reference/connectors/azure-connector-guide","permalink":"/empowernow_docs/docs/services/crud-service/reference/connectors/azure-connector-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/crud-service/reference/connectors/azure-connector-guide.md","tags":[],"version":"current","frontMatter":{"id":"azure-connector-guide","title":"Azure (Microsoft Graph) connector \u2013 capabilities and configuration","description":"Production\u2011grade Graph client in CRUD Service with retries, pagination, observability, flexible config, and standardized responses.","sidebar_label":"Azure connector guide"},"sidebar":"tutorialSidebar","previous":{"title":"Reference","permalink":"/empowernow_docs/docs/category/reference"},"next":{"title":"Azure connector overview","permalink":"/empowernow_docs/docs/services/crud-service/reference/connectors/azure-connector-overview"}}');var i=r(74848),c=r(28453);const d={id:"azure-connector-guide",title:"Azure (Microsoft Graph) connector \u2013 capabilities and configuration",description:"Production\u2011grade Graph client in CRUD Service with retries, pagination, observability, flexible config, and standardized responses.",sidebar_label:"Azure connector guide"},t=void 0,l={},o=[{value:"What it does",id:"what-it-does",level:2},{value:"Configuration (system\u2011level)",id:"configuration-systemlevel",level:2},{value:"Command configuration (per\u2011call)",id:"command-configuration-percall",level:2},{value:"Advanced query auto\u2011detection",id:"advanced-query-autodetection",level:2},{value:"API surface",id:"api-surface",level:2},{value:"Observability",id:"observability",level:2},{value:"Error handling and resilience",id:"error-handling-and-resilience",level:2},{value:"Rate limiting",id:"rate-limiting",level:2},{value:"Pagination behavior",id:"pagination-behavior",level:2},{value:"Examples",id:"examples",level:2},{value:"Authentication patterns",id:"authentication-patterns",level:2},{value:"Request header defaults",id:"request-header-defaults",level:2},{value:"Standardized response shape",id:"standardized-response-shape",level:2},{value:"Performance and tuning tips",id:"performance-and-tuning-tips",level:2},{value:"Common operational gotchas",id:"common-operational-gotchas",level:2},{value:"Security, secrets, and tokens",id:"security-secrets-and-tokens",level:2},{value:"Testing notes",id:"testing-notes",level:2},{value:"Changelog highlights",id:"changelog-highlights",level:2}];function a(e){const n={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The Azure connector in CRUD Service provides a production\u2011grade Microsoft Graph client with robust retries, pagination, observability, and flexible configuration. It\u2019s implemented in ",(0,i.jsx)(n.code,{children:"src/connectors/azure_connector.py"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"what-it-does",children:"What it does"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Authenticates to Microsoft Graph using either a bearer token or client credentials (via a credential manager)."}),"\n",(0,i.jsx)(n.li,{children:"Executes HTTP actions based on a command definition: method, endpoint, params, body, headers."}),"\n",(0,i.jsxs)(n.li,{children:["Adds advanced query headers for Graph features like ",(0,i.jsx)(n.code,{children:"$search"})," and ",(0,i.jsx)(n.code,{children:"$count"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Automatically follows ",(0,i.jsx)(n.code,{children:"@odata.nextLink"})," (auto\u2011pagination) with an opt\u2011out."]}),"\n",(0,i.jsxs)(n.li,{children:["Supports batch requests (",(0,i.jsx)(n.code,{children:"$batch"}),")."]}),"\n",(0,i.jsx)(n.li,{children:"Provides OpenTelemetry spans, metrics, and structured error mapping."}),"\n",(0,i.jsx)(n.li,{children:"Rate\u2011limits client\u2011side to protect against throttling."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"configuration-systemlevel",children:"Configuration (system\u2011level)"}),"\n",(0,i.jsxs)(n.p,{children:["Provide a dictionary to the connector when constructing, typically via YAML in ",(0,i.jsx)(n.code,{children:"config/systems/*.yaml"})," or programmatically. All keys are optional unless noted."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"base_url"})," (string)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Default: ",(0,i.jsx)(n.code,{children:"https://graph.microsoft.com/v1.0"})," (use ",(0,i.jsx)(n.code,{children:".../beta"})," if needed)"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"auth_type"})," (string)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Supported: ",(0,i.jsx)(n.code,{children:"azure"})," (client credentials), ",(0,i.jsx)(n.code,{children:"bearer"})," (static token)"]}),"\n",(0,i.jsxs)(n.li,{children:["Required for production flows: ",(0,i.jsx)(n.code,{children:"azure"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"token"})," (string)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Only when ",(0,i.jsx)(n.code,{children:'auth_type == "bearer"'})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"credentials"})," (object; for ",(0,i.jsx)(n.code,{children:'auth_type == "azure"'}),")","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"client_id"})," (required), ",(0,i.jsx)(n.code,{children:"client_secret"})," (required), ",(0,i.jsx)(n.code,{children:"tenant_id"})," (required), ",(0,i.jsx)(n.code,{children:"resource"})," (optional)"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"default_content_type"})," (string; default ",(0,i.jsx)(n.code,{children:"application/json"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"max_concurrent_requests"})," (int; default 4) \u2013 global semaphore limit"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rate_limit_key"})," (string; default ",(0,i.jsx)(n.code,{children:"base_url"}),") \u2013 scope for the global rate limiter"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"timeouts"})," (object) \u2013 maps to httpx.Timeout: ",(0,i.jsx)(n.code,{children:"connect/read/write/pool"})," in seconds"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"retry"})," (object)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"max_attempts"})," (default 4)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"backoff_base"})," (s, default 0.5)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"backoff_factor"})," (default 2.0)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"jitter"})," (s, default 0.1)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"retry_on_status"})," (default ",(0,i.jsx)(n.code,{children:"[408,429,500,502,503,504]"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"retry_after_header_names"})," (default ",(0,i.jsx)(n.code,{children:'["retry-after","x-ms-retry-after-ms","retry-after-ms"]'}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Honors ",(0,i.jsx)(n.code,{children:"Retry-After"})," headers automatically"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"logging"})," (object)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"enabled"}),", ",(0,i.jsx)(n.code,{children:"request"}),", ",(0,i.jsx)(n.code,{children:"response"}),", ",(0,i.jsx)(n.code,{children:"auth"}),", ",(0,i.jsx)(n.code,{children:"format"}),' ("basic" | "detailed"). Sensitive headers are masked.']}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"auto_paginate"})," (bool; default true)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"command-configuration-percall",children:"Command configuration (per\u2011call)"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"command_config"})," defines a call you pass to ",(0,i.jsx)(n.code,{children:"perform_action"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"method"})," (required): ",(0,i.jsx)(n.code,{children:"GET|POST|PATCH|PUT|DELETE"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"endpoint"})," (required): e.g., ",(0,i.jsx)(n.code,{children:"/users"}),", ",(0,i.jsx)(n.code,{children:"/groups/{id}"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"params"})," (object, optional): querystring map, e.g. ",(0,i.jsx)(n.code,{children:'{ "$top": 5, "$search": "\\"displayName:Admin\\"" }'})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"body"})," (object, optional): JSON payload for POST/PATCH/PUT"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"headers"})," (object, optional): merged with auth/default headers","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Auto\u2011sets ",(0,i.jsx)(n.code,{children:"client-request-id"})," and default ",(0,i.jsx)(n.code,{children:"Content-Type"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"auto_paginate"})," (bool, optional): override connector default"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["For GET/DELETE, ",(0,i.jsx)(n.code,{children:"params"})," is sent, and ",(0,i.jsx)(n.code,{children:"body"})," is not."]}),"\n",(0,i.jsxs)(n.li,{children:["For POST/PATCH/PUT, ",(0,i.jsx)(n.code,{children:"body"})," is sent as JSON."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"advanced-query-autodetection",children:"Advanced query auto\u2011detection"}),"\n",(0,i.jsx)(n.p,{children:"If the query uses advanced features, the connector sets:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Header: ",(0,i.jsx)(n.code,{children:"ConsistencyLevel: eventual"})]}),"\n",(0,i.jsxs)(n.li,{children:["Param: ",(0,i.jsx)(n.code,{children:"$count=true"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Detected keywords: ",(0,i.jsx)(n.code,{children:"$search"}),", ",(0,i.jsx)(n.code,{children:"$filter"}),", ",(0,i.jsx)(n.code,{children:"$count"}),", ",(0,i.jsx)(n.code,{children:"$orderby"}),", ",(0,i.jsx)(n.code,{children:"ne"}),", ",(0,i.jsx)(n.code,{children:"not"}),", ",(0,i.jsx)(n.code,{children:"endsWith"}),".\r\nYou can also force advanced mode via params/headers."]}),"\n",(0,i.jsx)(n.h2,{id:"api-surface",children:"API surface"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"perform_action(object_type, action, params, command_config, transaction_id=None, expected_outcomes=None, correlation_id=None, timeout=60.0)"})," \u2192 standardized response","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns dict where data is at ",(0,i.jsx)(n.code,{children:'result["response"]["data"]'})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"iter_pages(url, headers, timeout, correlation_id)"})," \u2192 async iterator of page dicts"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"perform_batch(requests, correlation_id=None, timeout=60.0, prefer=None, continue_on_error=False)"})," \u2192 standardized response"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"close()"})," \u2013 closes the shared httpx client"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"observability",children:"Observability"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OpenTelemetry","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Spans: ",(0,i.jsx)(n.code,{children:"azure.perform_action"})," (and internal ",(0,i.jsx)(n.code,{children:"azure.collect_pages"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Metrics (custom)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"azure.perform_action.duration"}),": histogram per method/action"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"azure.semaphore.wait.duration"}),": histogram for rate limiter waits"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"azure.request.retry.delay"}),": histogram per status"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"azure.request.retry.attempts"}),": histogram"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"azure.http_429"}),": counter"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"error-handling-and-resilience",children:"Error handling and resilience"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["All ",(0,i.jsx)(n.code,{children:"httpx.HTTPStatusError"})," are mapped into FastAPI ",(0,i.jsx)(n.code,{children:"HTTPException"})," with:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"status_code"}),": HTTP status"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"detail"}),": ",(0,i.jsx)(n.code,{children:'{ "error": "HTTP Error <code>", "upstream": { "url": "...", "detail": <upstream JSON> } }'})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Retries","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Enabled for statuses in ",(0,i.jsx)(n.code,{children:"retry_on_status"})]}),"\n",(0,i.jsxs)(n.li,{children:["Honors ",(0,i.jsx)(n.code,{children:"Retry-After"})," headers (including ",(0,i.jsx)(n.code,{children:"x-ms-retry-after-ms"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Token refresh","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensures auth headers are present and not expiring soon; refreshes within 5 minutes of expiry"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"rate-limiting",children:"Rate limiting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Global ",(0,i.jsx)(n.code,{children:"asyncio.Semaphore"})," keyed by ",(0,i.jsx)(n.code,{children:"rate_limit_key"})," bounds concurrency."]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.code,{children:"max_concurrent_requests"})," to adjust throughput."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"pagination-behavior",children:"Pagination behavior"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["When ",(0,i.jsx)(n.code,{children:"auto_paginate"})," is enabled and ",(0,i.jsx)(n.code,{children:"@odata.nextLink"})," is present, subsequent pages are fetched and returned as a consolidated dict:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{ "value": [/* all items */], "@odata.deltaLink": "<last delta link if present>" }\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["To fetch only a single page:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.code,{children:"command_config.auto_paginate = false"})]}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"$top"})," to reduce page size"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Minimal GET:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'result = await connector.perform_action(\r\n  object_type="user",\r\n  action="get_one",\r\n  params={},\r\n  command_config={"method": "GET", "endpoint": "/users?$top=5"},\r\n)\r\nusers = result["response"]["data"]\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Advanced search:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'result = await connector.perform_action(\r\n  object_type="user",\r\n  action="search",\r\n  params={},\r\n  command_config={\r\n    "method": "GET",\r\n    "endpoint": "/users",\r\n    "params": {"$search": "\\"displayName:Admin\\"", "$count": "true"},\r\n    "headers": {"ConsistencyLevel": "eventual"},\r\n  },\r\n)\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Create user:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'create_cmd = {\r\n  "method": "POST",\r\n  "endpoint": "/users",\r\n  "body": {\r\n    "accountEnabled": True,\r\n    "displayName": "SDK Test",\r\n    "mailNickname": "sdktest",\r\n    "userPrincipalName": "sdktest@contoso.com",\r\n    "passwordProfile": {"forceChangePasswordNextSignIn": True, "password": "P@ssw0rd123!"},\r\n  },\r\n}\r\nresult = await connector.perform_action("user", "create", {}, create_cmd)\r\nuser = result["response"]["data"]\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Single page only (no auto\u2011pagination):"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'single_page_cmd = {\r\n  "method": "GET",\r\n  "endpoint": "/users",\r\n  "params": {"$top": 5},\r\n  "auto_paginate": False,\r\n}\r\nresult = await connector.perform_action("user", "list", {}, single_page_cmd)\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Batch:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'out = await connector.perform_batch(\r\n  requests=[\r\n    {"id": "1", "method": "GET", "url": "/users?$top=1"},\r\n    {"id": "2", "method": "GET", "url": "/groups?$top=1"},\r\n  ],\r\n  continue_on_error=False,\r\n)\r\nassert out["response"]["success"] is True\n'})}),"\n",(0,i.jsx)(n.h2,{id:"authentication-patterns",children:"Authentication patterns"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Bearer token (testing)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:'auth_type: "bearer"'})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:'token: "<access_token>"'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Client credentials (recommended)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:'auth_type: "azure"'})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"credentials: { client_id, client_secret, tenant_id, resource? }"})}),"\n",(0,i.jsx)(n.li,{children:"Relies on credential manager and vault service to securely load and cache tokens"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"request-header-defaults",children:"Request header defaults"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"client-request-id"}),": correlation ID per call"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Content-Type"}),": ",(0,i.jsx)(n.code,{children:"default_content_type"})," when not provided"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ConsistencyLevel: eventual"})," auto\u2011added for advanced queries if not set"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"standardized-response-shape",children:"Standardized response shape"}),"\n",(0,i.jsxs)(n.p,{children:["All methods return a standardized dict; the actual data is at ",(0,i.jsx)(n.code,{children:'result["response"]["data"]'}),". For batch, ",(0,i.jsx)(n.code,{children:'result["response"]["success"]'})," summarizes success."]}),"\n",(0,i.jsx)(n.h2,{id:"performance-and-tuning-tips",children:"Performance and tuning tips"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["For smoke tests/dashboards, set ",(0,i.jsx)(n.code,{children:"auto_paginate: false"})," with small ",(0,i.jsx)(n.code,{children:"$top"})," to avoid large scans."]}),"\n",(0,i.jsxs)(n.li,{children:["Increase ",(0,i.jsx)(n.code,{children:"max_concurrent_requests"})," cautiously; Graph limits apply (~16 req/s per app)."]}),"\n",(0,i.jsxs)(n.li,{children:["Tune ",(0,i.jsx)(n.code,{children:"timeouts"})," and ",(0,i.jsx)(n.code,{children:"retry"})," based on network latencies and Graph behavior."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"common-operational-gotchas",children:"Common operational gotchas"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$search"})," requires ",(0,i.jsx)(n.code,{children:"ConsistencyLevel: eventual"}),". The connector often adds this automatically; you can also set it explicitly in headers."]}),"\n",(0,i.jsxs)(n.li,{children:["Device owners: some tenants return 400 for ",(0,i.jsx)(n.code,{children:"/devices/{id}/owners"})," on Device objects. Use ",(0,i.jsx)(n.code,{children:"/devices/{id}/registeredOwners"})," instead."]}),"\n",(0,i.jsxs)(n.li,{children:["License assignment requires a ",(0,i.jsx)(n.code,{children:"usageLocation"}),": set user ",(0,i.jsx)(n.code,{children:'PATCH { "usageLocation": "US" }'})," before ",(0,i.jsx)(n.code,{children:"assignLicense"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Audit logs require ",(0,i.jsx)(n.code,{children:"AuditLog.Read.All"})," (app\u2011only). Without it, Graph returns 403."]}),"\n",(0,i.jsxs)(n.li,{children:["Invitations require ",(0,i.jsx)(n.code,{children:"User.Invite.All"}),". Without it, Graph returns 401/403."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"security-secrets-and-tokens",children:"Security, secrets, and tokens"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Integrates with ",(0,i.jsx)(n.code,{children:"CredentialManager"})," and ",(0,i.jsx)(n.code,{children:"VaultService"})," to resolve credentials and cache tokens."]}),"\n",(0,i.jsx)(n.li,{children:"Tokens are refreshed when close to expiry."}),"\n",(0,i.jsx)(n.li,{children:"Sensitive headers are masked in logs."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"testing-notes",children:"Testing notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Unit tests: see ",(0,i.jsx)(n.code,{children:"tests/connectors/test_azure_connector.py"})]}),"\n",(0,i.jsxs)(n.li,{children:["Integration tests (live):","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"tests/integration/test_entraid_contractors_eid_live.py"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"tests/integration/test_entraid_contractors_eid_extended.py"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"changelog-highlights",children:"Changelog highlights"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Per\u2011command ",(0,i.jsx)(n.code,{children:"auto_paginate"})," with connector\u2011level default"]}),"\n",(0,i.jsx)(n.li,{children:"Improved advanced query detection and automatic header/param enrichment"}),"\n",(0,i.jsxs)(n.li,{children:["Enhanced retry with configurable status list and ",(0,i.jsx)(n.code,{children:"Retry\u2011After"})," handling"]}),"\n",(0,i.jsx)(n.li,{children:"More robust token refresh and default header merging"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"See also:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"services/crud-service/reference/connectors/azure-connector-overview"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"services/crud-service/reference/connectors/entra-admin-coverage"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"services/crud-service/reference/connectors/entra-graph-batch-examples"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);