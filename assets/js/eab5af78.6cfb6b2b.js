"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[3990],{3005:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"services/bff/explanation/bff_gateway","title":"bff_gateway","description":"BFF Gateway Architecture: Scenarios, Capabilities, and Comparison","source":"@site/docs/services/bff/explanation/bff_gateway.md","sourceDirName":"services/bff/explanation","slug":"/services/bff/explanation/bff_gateway","permalink":"/empowernow_docs/docs/services/bff/explanation/bff_gateway","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/bff/explanation/bff_gateway.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Architecture","permalink":"/empowernow_docs/docs/services/bff/explanation/architecture"},"next":{"title":"bff_gateway_technical","permalink":"/empowernow_docs/docs/services/bff/explanation/bff_gateway_technical"}}');var s=i(74848),a=i(28453);const t={},o=void 0,l={},c=[{value:"BFF Gateway Architecture: Scenarios, Capabilities, and Comparison",id:"bff-gateway-architecture-scenarios-capabilities-and-comparison",level:3},{value:"Executive summary",id:"executive-summary",level:4},{value:"Who it&#39;s for",id:"who-its-for",level:3},{value:"When to use the BFF",id:"when-to-use-the-bff",level:3},{value:"Quickstart",id:"quickstart",level:3},{value:"Market landscape overview",id:"market-landscape-overview",level:3},{value:"What API gateways solve (common challenges)",id:"what-api-gateways-solve-common-challenges",level:4},{value:"Vendor categories (representative examples)",id:"vendor-categories-representative-examples",level:4},{value:"Architectural approaches and flavors",id:"architectural-approaches-and-flavors",level:4},{value:"How our BFF aligns and differs",id:"how-our-bff-aligns-and-differs",level:4},{value:"Where they fit together (reference map)",id:"where-they-fit-together-reference-map",level:4},{value:"Supported scenarios",id:"supported-scenarios",level:3},{value:"SPA same-origin API (current)",id:"spa-same-origin-api-current",level:4},{value:"External API endpoint (BFF as API)",id:"external-api-endpoint-bff-as-api",level:4},{value:"SSE/Streaming",id:"ssestreaming",level:4},{value:"Capabilities by scenario",id:"capabilities-by-scenario",level:3},{value:"Configuration quick reference",id:"configuration-quick-reference",level:3},{value:"BFF vs Kong/Apigee: clear differentiation",id:"bff-vs-kongapigee-clear-differentiation",level:3},{value:"New enhancements (gateway PDP &amp; business logging)",id:"new-enhancements-gateway-pdp--business-logging",level:3},{value:"Ops playbook (high level)",id:"ops-playbook-high-level",level:3}];function d(e){const n={code:"code",h3:"h3",h4:"h4",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h3,{id:"bff-gateway-architecture-scenarios-capabilities-and-comparison",children:"BFF Gateway Architecture: Scenarios, Capabilities, and Comparison"}),"\n",(0,s.jsx)(n.h4,{id:"executive-summary",children:"Executive summary"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The BFF operates as an application-aware API gateway behind Traefik. It handles session-based auth, per-service token brokering, PDP authorization with rich business context, SSE streaming checks, and Kafka-structured business audit."}),"\n",(0,s.jsx)(n.li,{children:"Traefik fronts TLS/routing; the BFF provides domain-aware policy enforcement and orchestration. The same model supports external callers (BFF as the public API endpoint) and SPA same-origin calls."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"who-its-for",children:"Who it's for"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Platform/Infrastructure engineers"}),": need an application-aware policy layer behind Traefik/Kong with observability and central PDP integration."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backend service owners"}),": want consistent auth/authz, per-service token brokering, canonical ARNs/correlation headers, and audit out-of-the-box."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Frontend/SPA teams"}),": same-origin API with session UX (return_to), SSE-aware authorization, and zero bespoke auth code per page."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Security/Identity teams"}),": centralized PDP enforcement with business context and structured Kafka audit to verify policy outcomes."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"when-to-use-the-bff",children:"When to use the BFF"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Domain-aware authorization is required"}),": decisions depend on resource/action/id extracted from path/body, not only on generic scopes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Per-service token brokering"}),": user session \u2192 audience/scope-mapped tokens per upstream service."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SSE/streaming authorization"}),": PDP pre-check before opening long-lived connections."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enterprise observability"}),": Prometheus metrics plus standardized Kafka business events (",(0,s.jsx)(n.code,{children:"AUTHZ_DECISION"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Config-first, code-centric extensions"}),": ",(0,s.jsx)(n.code,{children:"routes.yaml"}),"/",(0,s.jsx)(n.code,{children:"pdp.yaml"})," with the option to extend behavior in code when needed."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Not a fit for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Global edge concerns"}),": WAF/bot/DDOS, geo routing/CDN, API productization/monetization \u2013 keep these at the edge (Traefik/Kong/Cloudflare/Akamai)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Non-HTTP multi-protocol"})," or global control planes \u2013 use specialized gateways/meshes."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"quickstart",children:"Quickstart"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Define a route with session/bearer auth and PDP on:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'- id: "crud-execute"\n  path: "/api/crud/execute"\n  target_service: "crud_service"\n  upstream_path: "/execute"\n  methods: ["POST"]\n  auth: "session"   # or "bearer" for machine-to-machine\n  authz: "pdp"\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Map the endpoint to policy inputs in ",(0,s.jsx)(n.code,{children:"pdp.yaml"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'endpoint_map:\n  /api/crud/execute:\n    POST:\n      resource: "crud:command"\n      action: "execute"\n      props:\n        system: "$.system"\n        object_type: "$.object_type"\n        command: "$.action"\n        SystemIdentifier: "$.params.SystemIdentifier"\n        id: "$.params.id"\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"Ensure PDP is globally enabled:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"authz_enabled: bool = True\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsx)(n.li,{children:"Deploy and test:"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Send a POST to ",(0,s.jsx)(n.code,{children:"/api/crud/execute"})," with a valid session/JWT; expect 200 from upstream if PDP allows, or 403 if denied."]}),"\n",(0,s.jsxs)(n.li,{children:["For SSE routes, add ",(0,s.jsx)(n.code,{children:"authz: pdp"})," and a corresponding ",(0,s.jsx)(n.code,{children:"endpoint_map"}),"; the BFF denies early when unauthorized."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"market-landscape-overview",children:"Market landscape overview"}),"\n",(0,s.jsx)(n.h4,{id:"what-api-gateways-solve-common-challenges",children:"What API gateways solve (common challenges)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Security and access: TLS/mTLS termination, OAuth2/OIDC, WAF, rate limiting, IP reputation."}),"\n",(0,s.jsx)(n.li,{children:"Traffic management: routing, retries, timeouts, canary/blue\u2011green, global anycast/CDN edge."}),"\n",(0,s.jsx)(n.li,{children:"API productization: developer portals, keys/quotas/monetization, versioning and lifecycle."}),"\n",(0,s.jsx)(n.li,{children:"Observability: metrics/tracing/logging, audit, anomaly detection."}),"\n",(0,s.jsx)(n.li,{children:"Transformation and mediation: headers/body transformation, protocol bridging, schema validation."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"vendor-categories-representative-examples",children:"Vendor categories (representative examples)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Managed cloud gateways: AWS API Gateway / API GW + ALB, Azure API Management, Google Apigee/X."}),"\n",(0,s.jsx)(n.li,{children:"Self\u2011managed/commercial & OSS: Kong (Gateway/Enterprise), Tyk, NGINX, Traefik Enterprise, WSO2."}),"\n",(0,s.jsx)(n.li,{children:"Security/perimeter/CDN: Cloudflare, Akamai (incl. WAF/bot protection), F5."}),"\n",(0,s.jsx)(n.li,{children:"Integration/iPaaS platforms: MuleSoft/Anypoint, Boomi, SnapLogic (API mgmt modules)."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"architectural-approaches-and-flavors",children:"Architectural approaches and flavors"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Edge API gateways (L7 at perimeter) focusing on scale, security, traffic control."}),"\n",(0,s.jsx)(n.li,{children:"Internal/BFF gateways (app\u2011aware) close to services/UI, adding session UX, business context."}),"\n",(0,s.jsx)(n.li,{children:"Service mesh & gateways: Istio/Envoy/Consul for east\u2011west traffic; ingress/egress gateways."}),"\n",(0,s.jsx)(n.li,{children:"Policy engines: OPA/Rego (embedded/sidecar) vs. centralized PDP (AuthZEN/XACML/ABAC)."}),"\n",(0,s.jsx)(n.li,{children:"Extension models: plugin\u2011based (Lua/Go/JS), config\u2011driven (YAML/CRDs), or code\u2011centric (BFF)."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"how-our-bff-aligns-and-differs",children:"How our BFF aligns and differs"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Aligns with gateways on: L7 routing/proxy, OAuth2/OIDC authentication, PDP\u2011backed authorization, metrics and logging."}),"\n",(0,s.jsxs)(n.li,{children:["Differs by being application\u2011aware:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Session UX and return_to handling, SSE\u2011aware authorization."}),"\n",(0,s.jsx)(n.li,{children:"Per\u2011service token brokering from a user session; audience/scope mapping."}),"\n",(0,s.jsxs)(n.li,{children:["Business\u2011context PDP via ",(0,s.jsx)(n.code,{children:"endpoint_map"})," (resource/action/id from path/body), not just generic edge checks."]}),"\n",(0,s.jsxs)(n.li,{children:["Kafka\u2011structured business audit (",(0,s.jsx)(n.code,{children:"AUTHZ_DECISION"})," with ARNs, route_id, correlation) and Prometheus metrics tailored to decisions/latency."]}),"\n",(0,s.jsx)(n.li,{children:"First\u2011party plugin allow\u2011listing and domain\u2011specific headers (canonical ARNs) propagation."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"What we intentionally do not replace: WAF/bot protection at global edge, multi\u2011tenant API productization (dev portal/monetization), TCP/UDP L4, global control planes\u2014delegate to Traefik/Kong/Cloudflare/Akamai as needed."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"where-they-fit-together-reference-map",children:"Where they fit together (reference map)"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TD\n  Edge["Edge API Gateways<br/>(Kong | Tyk | NGINX | Traefik Enterprise | Cloudflare | Akamai)"] --\x3e|routes to| BFF["BFF Gateway (App-aware)"]\n  Cloud["Managed API Gateways<br/>(AWS API Gateway | Azure APIM | Apigee/X)"] --\x3e|alternatively| BFF\n  Mesh["Service Mesh / Ingress<br/>(Istio | Envoy | Consul)"] --\x3e|internal traffic| Services["Backend Services"]\n  BFF --\x3e|per-service tokens| Services\n  BFF --\x3e|PDP decisions| PDP["Central PDP (AuthZEN)"]'}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"supported-scenarios",children:"Supported scenarios"}),"\n",(0,s.jsx)(n.h4,{id:"spa-same-origin-api-current",children:"SPA same-origin API (current)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Flow: SPA \u2192 /api/* \u2192 Traefik \u2192 BFF \u2192 internal service"}),"\n",(0,s.jsx)(n.li,{children:"Features: session auth, PDP per-route (authz: pdp), per-service tokens, SSE pre-checks, correlation, ARNs, Kafka audit, Prometheus metrics"}),"\n"]}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant SPA\n  participant Traefik\n  participant BFF\n  participant PDP\n  participant CRUD\n\n  SPA->>Traefik: GET /api/crud/workflows\n  Traefik->>BFF: Forward /api/crud/workflows\n  BFF->>BFF: Session/JWT auth check\n  BFF->>PDP: Evaluate(resource=workflow, action=list)\n  PDP--\x3e>BFF: decision=Allow\n  BFF->>CRUD: Proxy with service token + ARNs + correlation ID\n  CRUD--\x3e>BFF: 200 JSON\n  BFF--\x3e>SPA: 200 JSON"}),"\n",(0,s.jsx)(n.h4,{id:"external-api-endpoint-bff-as-api",children:"External API endpoint (BFF as API)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Flow: External Client \u2192 api.example.com \u2192 Traefik \u2192 BFF \u2192 upstreams"}),"\n",(0,s.jsx)(n.li,{children:"Additions: edge TLS/WAF/rate-limit at Traefik; BFF remains policy and orchestration engine"}),"\n"]}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant Client\n  participant Traefik\n  participant BFF\n  participant PDP\n  participant ServiceX\n\n  Client->>Traefik: POST /api/svc/x/orders\n  Traefik->>BFF: Forward /api/svc/x/orders\n  BFF->>BFF: Auth (session/JWT/client credentials)\n  BFF->>PDP: Evaluate(resource=orders, action=create, id=from path/body)\n  PDP--\x3e>BFF: decision=Allow/Deny\n  alt Allow\n    BFF->>ServiceX: Proxy request\n    Note right of BFF: inject service token and ARNs\n    ServiceX--\x3e>BFF: 201 JSON\n    BFF--\x3e>Client: 201 JSON\n  else Deny\n    BFF--\x3e>Client: 403 Forbidden\n  end"}),"\n",(0,s.jsx)(n.h4,{id:"ssestreaming",children:"SSE/Streaming"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PDP enforced before opening stream; deny early if unauthorized. Origin checks applied."}),"\n"]}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant SPA\n  participant Traefik\n  participant BFF\n  participant PDP\n  participant CRUD\n\n  SPA->>Traefik: GET /api/crud/events/workflow (SSE)\n  Traefik->>BFF: Forward SSE\n  BFF->>PDP: Evaluate(resource=workflow:status, action=read)\n  PDP--\x3e>BFF: decision=Allow\n  BFF->>CRUD: Open SSE upstream\n  CRUD--\x3e>BFF: stream events\n  BFF--\x3e>SPA: stream events"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"capabilities-by-scenario",children:"Capabilities by scenario"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Authentication"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Session-based and JWT; route-level auth types from ",(0,s.jsx)(n.code,{children:"ServiceConfigs/BFF/config/routes.yaml"})," (",(0,s.jsx)(n.code,{children:"auth: session|none|bearer"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Global PDP toggle: ",(0,s.jsx)(n.code,{children:"authz_enabled"})," in ",(0,s.jsx)(n.code,{children:"ms_bff/src/core/config.py"})," (can be driven by env via settings loader)."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Authorization (PDP)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Route-level ",(0,s.jsx)(n.code,{children:"authz: pdp"})," in ",(0,s.jsx)(n.code,{children:"ServiceConfigs/BFF/config/routes.yaml"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Mapping for resource/action/id via ",(0,s.jsx)(n.code,{children:"ServiceConfigs/BFF/config/pdp.yaml"})," ",(0,s.jsx)(n.code,{children:"endpoint_map"})," (supports path params ",(0,s.jsx)(n.code,{children:"{id}"})," and ",(0,s.jsx)(n.code,{children:"$.json.paths"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Global kill-switch: ",(0,s.jsx)(n.code,{children:"settings.authz_enabled"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Authorization enforced for both regular and streaming routes before proxying."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Token brokering"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Session manager issues per-service access tokens and injects them per call."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Observability"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Prometheus: ",(0,s.jsx)(n.code,{children:"bff_authz_requests_total{decision,resource}"}),", ",(0,s.jsx)(n.code,{children:"bff_authz_latency_seconds"}),", service request/error/latency, cache metrics."]}),"\n",(0,s.jsxs)(n.li,{children:["Kafka-structured business logs:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"AUTHZ_DECISION"}),": Allow|Deny|NoMapping with ",(0,s.jsx)(n.code,{children:"route_id"}),", ",(0,s.jsx)(n.code,{children:"subject"}),", ",(0,s.jsx)(n.code,{children:"resource"}),", ",(0,s.jsx)(n.code,{children:"action"}),", ",(0,s.jsx)(n.code,{children:"resource_id"}),", ",(0,s.jsx)(n.code,{children:"principal_arn"}),", ",(0,s.jsx)(n.code,{children:"actor_arn"}),", ",(0,s.jsx)(n.code,{children:"correlation_id"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"PDP client logs for token fetch, request success/error, cache."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Dashboard + alerts (provided):","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"observability/grafana/dashboard_bff_authz.json"})," (deny rates, PDP errors, latency)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"observability/grafana/alerts_bff_authz.yaml"})," (deny rate high, PDP error spike, NoMapping events)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"SSE specifics"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PDP pre-check before opening stream; deny early."}),"\n",(0,s.jsx)(n.li,{children:"CORS/origin enforcement in middleware."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"configuration-quick-reference",children:"Configuration quick reference"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Route security and PDP"})," (",(0,s.jsx)(n.code,{children:"ServiceConfigs/BFF/config/routes.yaml"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'- id: "crud-execute"\n  path: "/api/crud/execute"\n  target_service: "crud_service"\n  upstream_path: "/execute"\n  methods: ["POST"]\n  auth: "session"\n  authz: "pdp"\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Endpoint mapping (PDP)"})," (",(0,s.jsx)(n.code,{children:"ServiceConfigs/BFF/config/pdp.yaml"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'endpoint_map:\n  /api/crud/execute:\n    POST:\n      resource: "crud:command"\n      action: "execute"\n      props:\n        system: "$.system"\n        object_type: "$.object_type"\n        command: "$.action"\n        SystemIdentifier: "$.params.SystemIdentifier"\n        id: "$.params.id"\n  /api/crud/workflow/resume/{task_id}:\n    POST:\n      resource: "workflow"\n      id_from: "{task_id}"\n      action: "resume"\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Global toggle"})," (",(0,s.jsx)(n.code,{children:"ms_bff/src/core/config.py"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"authz_enabled: bool = True  # set False to disable PDP globally\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"bff-vs-kongapigee-clear-differentiation",children:"BFF vs Kong/Apigee: clear differentiation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What the BFF offers (application-aware)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Session flows (login redirects, return_to), SSE-aware authorization, per-service token brokering, domain-aware authorization (resource/action/id) via body/path extraction, enterprise audit (Kafka ",(0,s.jsx)(n.code,{children:"AUTHZ_DECISION"})," with ARNs), Prometheus metrics tailored to business auth decisions, SDK integration (FIPS-friendly clients), plugin enforcer for internal plugin calls."]}),"\n",(0,s.jsxs)(n.li,{children:["Config-driven: ",(0,s.jsx)(n.code,{children:"routes.yaml"})," for routing; ",(0,s.jsx)(n.code,{children:"pdp.yaml"})," for policy mapping; ",(0,s.jsx)(n.code,{children:"authz_enabled"})," for global control."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What the BFF doesn\u2019t attempt to replace"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"At-scale edge/WAF/DDOS, API productization (dev portal, monetization, per-consumer plans), L4/L7 multi-protocol, global control planes. Use Traefik/Kong for those outer-edge concerns if needed."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Complementary model"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Traefik/Kong at the edge; BFF inside as the application-aware policy gateway."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"new-enhancements-gateway-pdp--business-logging",children:"New enhancements (gateway PDP & business logging)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Generic PDP pre-check for regular and streaming routes based on ",(0,s.jsx)(n.code,{children:"authz: pdp"})," with a global ",(0,s.jsx)(n.code,{children:"authz_enabled"})," switch."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"AuthzResolver"})," for body/path \u2192 resource/action/id mapping per ",(0,s.jsx)(n.code,{children:"pdp.yaml"})," endpoint_map."]}),"\n",(0,s.jsxs)(n.li,{children:["Standardized Kafka ",(0,s.jsx)(n.code,{children:"AUTHZ_DECISION"})," events (Allow/Deny/NoMapping) including route_id, subject, ARNs, correlation ID."]}),"\n",(0,s.jsx)(n.li,{children:"Prometheus metrics and dashboard/alerts for deny rate and PDP errors."}),"\n",(0,s.jsx)(n.li,{children:"Workflow endpoint consolidated to rely on generic PEP."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"ops-playbook-high-level",children:"Ops playbook (high level)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Rollout: enable PDP per route via ",(0,s.jsx)(n.code,{children:"authz: pdp"}),"; keep ",(0,s.jsx)(n.code,{children:"authz_enabled=True"}),"; staged rollout by route groups; fallback: set toggle to false."]}),"\n",(0,s.jsx)(n.li,{children:"Monitoring: import Grafana dashboard and alerts; watch deny rate, PDP errors, latency p95."}),"\n",(0,s.jsxs)(n.li,{children:["Tuning: adjust PDP cache TTLs, retry/backoff, circuit-breaker in ",(0,s.jsx)(n.code,{children:"pdp.yaml"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var r=i(96540);const s={},a=r.createContext(s);function t(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);