"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[9104],{28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var s=i(96540);const r={},o=s.createContext(r);function t(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(o.Provider,{value:n},e.children)}},64399:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"services/identity-fabric/index","title":"EmpowerNow Identity Fabric \u2013 Suite Overview","description":"High-level overview of the EmpowerNow Identity Fabric, including ingress, identity, policy, data services, eventing, analytics, and observability. Includes a system diagram and core hostnames.","source":"@site/docs/services/identity-fabric/index.md","sourceDirName":"services/identity-fabric","slug":"/services/identity-fabric/","permalink":"/empowernow_docs/docs/services/identity-fabric/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/identity-fabric/index.md","tags":[],"version":"current","frontMatter":{"id":"index","title":"EmpowerNow Identity Fabric \u2013 Suite Overview","description":"High-level overview of the EmpowerNow Identity Fabric, including ingress, identity, policy, data services, eventing, analytics, and observability. Includes a system diagram and core hostnames."},"sidebar":"tutorialSidebar","previous":{"title":"EmpowerNow Documentation","permalink":"/empowernow_docs/docs/intro"},"next":{"title":"CRUD Service","permalink":"/empowernow_docs/docs/services/crud-service/"}}');var r=i(74848),o=i(28453);const t={id:"index",title:"EmpowerNow Identity Fabric \u2013 Suite Overview",description:"High-level overview of the EmpowerNow Identity Fabric, including ingress, identity, policy, data services, eventing, analytics, and observability. Includes a system diagram and core hostnames."},a=void 0,c={},d=[{value:"Note: Canonical provider aliases in ARNs",id:"note-canonical-provider-aliases-in-arns",level:3},{value:"Key roles at a glance",id:"key-roles-at-a-glance",level:3},{value:"Core hostnames (examples)",id:"core-hostnames-examples",level:3},{value:"Hybrid connectivity to on\u2011premises systems",id:"hybrid-connectivity-to-onpremises-systems",level:3}];function l(e){const n={a:"a",code:"code",h3:"h3",li:"li",mermaid:"mermaid",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"The EmpowerNow Identity Fabric is a modular suite that provides identity, policy, workflow/CRUD execution, eventing, analytics, and observability. This page shows how the pieces fit together end\u2011to\u2011end."}),"\n",(0,r.jsx)(n.mermaid,{value:'flowchart LR\n  %% Edge\n  subgraph edge["Edge (Browsers & SPAs)"]\n    SPA1["authn.ocg.labs.empowernow.ai (IdP UI)"]\n    SPA2["authz.ocg.labs.empowernow.ai (Policy UI)"]\n    SPA3["automate.ocg.labs.empowernow.ai (Workflow UI)"]\n    SPA4["frontend.ocg.labs.empowernow.ai"]\n    SPA5["runner.ocg.labs.empowernow.ai"]\n  end\n\n  %% Ingress\n  subgraph ingress["Ingress"]\n    TRAEFIK["Traefik"]\n  end\n\n  SPA1 --\x3e TRAEFIK\n  SPA2 --\x3e TRAEFIK\n  SPA3 --\x3e TRAEFIK\n  SPA4 --\x3e TRAEFIK\n  SPA5 --\x3e TRAEFIK\n\n  %% Control plane\n  subgraph control["Control Plane"]\n    BFF["BFF (Session terminator, proxy)"]\n    IDP["IdP (OIDC, CAEP, MCP)"]\n    PDP["PDP (Authorization)"]\n    REDIS[(Shared Redis)]\n  end\n\n  TRAEFIK --\x3e BFF\n  BFF <--\x3e REDIS\n  BFF --\x3e IDP\n  BFF --\x3e PDP\n\n  %% Data plane services\n  subgraph data["Data Plane Services"]\n    CRUD["CRUD Service"]\n    NAMING["Naming Service"]\n    MEMBERSHIP["Membership Service"]\n  end\n\n  %% Data stores\n  subgraph stores["Primary Data Stores"]\n    POSTGRES[(PostgreSQL)]\n    NEO4J[(Neo4j)]\n    LDAP[(OpenLDAP)]\n  end\n\n  %% Eventing & analytics\n  subgraph eventing["Eventing"]\n    KAFKA["Kafka"]\n    KAFDROP["Kafdrop"]\n  end\n\n  subgraph analytics["Analytics"]\n    ANALYTICS["Analytics Service"]\n    CLICKHOUSE[(ClickHouse)]\n  end\n\n  %% Observability\n  subgraph obs["Observability"]\n    OTEL["OTel Collector"]\n    PROM["Prometheus"]\n    GRAF["Grafana"]\n    LOKI["Loki"]\n    JAEGER["Jaeger"]\n    VECTOR["Vector"]\n  end\n\n  %% BFF as gateway to backends (audience tokens)\n  BFF --\x3e CRUD\n  BFF --\x3e MEMBERSHIP\n  BFF --\x3e NAMING\n  BFF --\x3e ANALYTICS\n  BFF -. OIDC tokens .-> IDP\n\n  %% Service \u2194 store relationships\n  CRUD --\x3e POSTGRES\n  MEMBERSHIP --\x3e NEO4J\n  IDP --\x3e LDAP\n\n  %% Event flows\n  CRUD -- business/error events --\x3e KAFKA\n  PDP -- authz events/metrics --\x3e KAFKA\n  IDP -- security/CAEP --\x3e KAFKA\n  ANALYTICS -- consumes --\x3e KAFKA\n  ANALYTICS <--\x3e CLICKHOUSE\n\n  %% Observability flows (simplified)\n  BFF -. OTLP .-> OTEL\n  CRUD -. OTLP .-> OTEL\n  PDP -. OTLP .-> OTEL\n  IDP -. OTLP .-> OTEL\n  ANALYTICS -. OTLP .-> OTEL\n  BFF -. /metrics .-> PROM\n  CRUD -. /metrics .-> PROM\n  PDP -. /metrics .-> PROM\n  IDP -. /metrics .-> PROM\n  ANALYTICS -. /metrics .-> PROM\n  VECTOR --\x3e LOKI\n  OTEL --\x3e JAEGER\n  GRAF --- PROM\n  GRAF --- LOKI\n  GRAF --- JAEGER\n\n  %% Utilities\n  KAFDROP --- KAFKA'}),"\n",(0,r.jsx)(n.h3,{id:"note-canonical-provider-aliases-in-arns",children:"Note: Canonical provider aliases in ARNs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Purpose: introduce a canonical ",(0,r.jsx)(n.code,{children:"provider"})," alias so identities (ARNs) are stable across multiple IdP entries that share the same issuer but differ by audience (e.g., admin vs CRUD)."]}),"\n",(0,r.jsxs)(n.li,{children:["Behavior: services that construct identities prefer the IdP config ",(0,r.jsx)(n.code,{children:"provider"})," field (fallback: ",(0,r.jsx)(n.code,{children:"name"}),") for the provider segment of ARNs. Claims injected downstream include ",(0,r.jsx)(n.code,{children:"idp_name"})," and ",(0,r.jsx)(n.code,{children:"provider"})," aligned to this alias."]}),"\n",(0,r.jsxs)(n.li,{children:["Effect: tokens for the same issuer now yield the same provider namespace in ARNs, e.g., ",(0,r.jsx)(n.code,{children:"auth:account:empowernow:{sub}"})," regardless of audience entry name."]}),"\n",(0,r.jsxs)(n.li,{children:["Migration: safe to deploy code first (falls back to ",(0,r.jsx)(n.code,{children:"name"}),"); then add ",(0,r.jsx)(n.code,{children:'provider: "empowernow"'})," to relevant IdP entries in ",(0,r.jsx)(n.code,{children:"ServiceConfigs/*/config/idps.yaml"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Testing: verify ",(0,r.jsx)(n.code,{children:"unique_id"})," starts with ",(0,r.jsx)(n.code,{children:"auth:account:empowernow:"})," and that claims contain ",(0,r.jsx)(n.code,{children:"idp_name"}),"/",(0,r.jsx)(n.code,{children:"provider"})," for both admin and CRUD audience tokens."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"key-roles-at-a-glance",children:"Key roles at a glance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"BFF: Terminates SPA sessions; proxies to backends using audience\u2011bound access tokens minted by the IdP."}),"\n",(0,r.jsx)(n.li,{children:"IdP: OIDC provider (tokens, introspection); emits CAEP/security events; exposes MCP."}),"\n",(0,r.jsx)(n.li,{children:"PDP: Central authorization decisions; emits authz events/metrics."}),"\n",(0,r.jsx)(n.li,{children:"CRUD Service: Executes workflow/CRUD commands; emits business/error events."}),"\n",(0,r.jsx)(n.li,{children:"Membership: Graph of identities/relationships (Neo4j)."}),"\n",(0,r.jsx)(n.li,{children:"Analytics: Consumes Kafka events, persists to ClickHouse, serves analytics APIs."}),"\n",(0,r.jsx)(n.li,{children:"Traefik: Ingress routing for SPAs and BFF."}),"\n",(0,r.jsx)(n.li,{children:"Observability: OTEL traces (Jaeger), metrics (Prometheus), logs (Vector\u2192Loki), dashboards (Grafana)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"core-hostnames-examples",children:"Core hostnames (examples)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Ingress/edge: ",(0,r.jsx)(n.code,{children:"traefik.ocg.labs.empowernow.ai"})]}),"\n",(0,r.jsxs)(n.li,{children:["BFF/API: ",(0,r.jsx)(n.code,{children:"api.ocg.labs.empowernow.ai"})]}),"\n",(0,r.jsxs)(n.li,{children:["SPAs: ",(0,r.jsx)(n.code,{children:"authn.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"authz.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"automate.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"frontend.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"runner.ocg.labs.empowernow.ai"})]}),"\n",(0,r.jsxs)(n.li,{children:["Backends: ",(0,r.jsx)(n.code,{children:"idp.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"crud.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"pdp.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"analytics.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"naming.ocg.labs.empowernow.ai"})]}),"\n",(0,r.jsxs)(n.li,{children:["Observability: ",(0,r.jsx)(n.code,{children:"prometheus.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"grafana.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"jaeger.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"kafdrop.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"clickhouse.ocg.labs.empowernow.ai"}),", ",(0,r.jsx)(n.code,{children:"tabix.ocg.labs.empowernow.ai"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"See service\u2011specific sections for deep dives, configuration, and runbooks."}),"\n",(0,r.jsx)(n.h3,{id:"hybrid-connectivity-to-onpremises-systems",children:"Hybrid connectivity to on\u2011premises systems"}),"\n",(0,r.jsx)(n.p,{children:"Some deployments require cloud/containerized services to communicate with on\u2011premises services (for example, enterprise LDAP/Active Directory or SAP LDAP) without opening inbound firewall ports. The recommended approach is to use Azure Relay with the Azure Relay Bridge (azbridge) to create secure outbound tunnels from the on\u2011premises network."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["See: ",(0,r.jsx)(n.a,{href:"/docs/services/identity-fabric/azure-relay-bridge",children:"Azure Relay Bridge (azbridge)"})," for architecture, Docker Compose examples, connection patterns (LDAP/LDAPS), security notes, and troubleshooting."]}),"\n",(0,r.jsxs)(n.li,{children:["Example consumers: ",(0,r.jsx)(n.code,{children:"crud-service"})," (workflows needing LDAP), ",(0,r.jsx)(n.code,{children:"idp"})," (directory lookups), or any service on the same Docker network as the bridge containers."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);