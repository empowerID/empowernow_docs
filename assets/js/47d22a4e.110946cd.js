"use strict";(self.webpackChunkempowernow_docs=self.webpackChunkempowernow_docs||[]).push([[1844],{27717:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"services/bff/how-to/qa-test-execution","title":"QA \u2014 BFF Test Execution (Verified Steps)","description":"Source of truth: msbffspike/msbff/TESTEXECUTION_GUIDE.md (summarized here for quick use).","source":"@site/docs/services/bff/how-to/qa-test-execution.md","sourceDirName":"services/bff/how-to","slug":"/services/bff/how-to/qa-test-execution","permalink":"/empowernow_docs/docs/services/bff/how-to/qa-test-execution","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/bff/how-to/qa-test-execution.md","tags":[],"version":"current","frontMatter":{"title":"QA \u2014 BFF Test Execution (Verified Steps)"},"sidebar":"tutorialSidebar","previous":{"title":"Protect Endpoints (dependencies and decorators)","permalink":"/empowernow_docs/docs/services/bff/how-to/protect-endpoints"},"next":{"title":"Configure Rate Limiting (Traefik + BFF)","permalink":"/empowernow_docs/docs/services/bff/how-to/rate-limiting"}}');var t=n(74848),o=n(28453);const i={title:"QA \u2014 BFF Test Execution (Verified Steps)"},c=void 0,a={},l=[];function d(e){const s={code:"code",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:["Source of truth: ",(0,t.jsx)(s.code,{children:"ms_bff_spike/ms_bff/TEST_EXECUTION_GUIDE.md"})," (summarized here for quick use)."]}),"\n",(0,t.jsx)(s.p,{children:"What this proves"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Traefik ForwardAuth \u2192 BFF chain works"}),"\n",(0,t.jsx)(s.li,{children:"Middleware/routing is correct"}),"\n",(0,t.jsx)(s.li,{children:"Real user workflows across IdP UI, Visual Designer, and PDP UI work end\u2011to\u2011end"}),"\n",(0,t.jsx)(s.li,{children:"No auth bypass; sessions work across SPAs"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Prereqs"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Docker + Compose installed and running"}),"\n",(0,t.jsx)(s.li,{children:"Hosts file entries for local domains"}),"\n",(0,t.jsx)(s.li,{children:"Test credentials configured"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Hosts entries (required)"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"127.0.0.1 authn.ocg.labs.empowernow.ai\r\n127.0.0.1 automate.ocg.labs.empowernow.ai\r\n127.0.0.1 authz.ocg.labs.empowernow.ai\r\n127.0.0.1 api.ocg.labs.empowernow.ai\r\n127.0.0.1 idp.ocg.labs.empowernow.ai\r\n127.0.0.1 traefik.ocg.labs.empowernow.ai\n"})}),"\n",(0,t.jsx)(s.p,{children:"Local routing (visual)"}),"\n",(0,t.jsx)(s.mermaid,{value:"graph TD\r\n    A[Browser/Tests<br/>*.ocg.labs.empowernow.ai] --\x3e|Hosts\u2192127.0.0.1| B[Traefik 80/443]\r\n    B --\x3e|Host header routing| C[BFF API bff_app:8000]\r\n    B --\x3e|Host header routing| D[SPA Static Files]\r\n    C --\x3e|internal network| E[IdP idp-app:8002]\r\n    C --\x3e|internal network| F[CRUD crud-service:8000]\r\n    C --\x3e|internal network| G[PDP pdp_app:8001]\r\n    C --\x3e|internal network| H[Redis shared_redis:6379]"}),"\n",(0,t.jsx)(s.p,{children:"Start services"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"cd CRUDService\r\ndocker-compose -f docker-compose-authzen4.yml up -d\n"})}),"\n",(0,t.jsx)(s.p,{children:"Quick health checks"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'docker-compose -f docker-compose-authzen4.yml ps\r\ncurl -f http://localhost:8000/health || echo "BFF health check failed"\r\ncurl -f http://localhost:8080/ping || echo "Traefik ping failed"\n'})}),"\n",(0,t.jsx)(s.p,{children:"Set credentials (examples)"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'export TEST_USERNAME="test"\r\nexport TEST_PASSWORD="p@$$w0rd"\n'})}),"\n",(0,t.jsx)(s.p,{children:"Run critical tests"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# From ms_bff_spike/ms_bff\r\npython -m pytest tests/integration/test_traefik_forwardauth.py::test_integration_traefik_forwardauth_full_flow -v -s\r\npython -m pytest tests/integration/test_traefik_middleware_config.py::test_integration_traefik_middleware_chain -v -s\r\npython -m pytest tests/e2e/test_real_user_workflows.py::test_real_user_workflow_integration -v -s\n"})}),"\n",(0,t.jsx)(s.p,{children:"Expected outcomes"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"ForwardAuth integration: PASS (<500ms typical)"}),"\n",(0,t.jsx)(s.li,{children:"Middleware chain: PASS"}),"\n",(0,t.jsx)(s.li,{children:"Real user workflows (all 3 SPAs): PASS"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Common quick fixes"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"401 loop: ensure hosts entries + valid credentials + BFF up"}),"\n",(0,t.jsx)(s.li,{children:"DNS errors: hosts file not configured"}),"\n",(0,t.jsx)(s.li,{children:"Connection refused: stack not running; check compose ps/logs"}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>c});var r=n(96540);const t={},o=r.createContext(t);function i(e){const s=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);